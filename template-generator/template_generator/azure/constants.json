{% set failover_cmd_array %}
{% if nics == 'n'%}
"15": "tmsh modify sys db failover.selinuxallowscripts value enable",
"14": "tmsh modify sys db failover.selinuxallowscripts value enable",
"13": "tmsh list sys db",
"12": "tmsh list sys db",
"latest": "tmsh modify sys db failover.selinuxallowscripts value enable"
{% elif nics == '3' %}
"No": {
"first": "[concat('tmsh modify cm device ', concat(variables('instanceName'), '0.', variables('location'), '.cloudapp.azure.com'), ' unicast-address none')]",
"second": "[concat('tmsh modify cm device ', concat(variables('instanceName'), '1.', variables('location'), '.cloudapp.azure.com'), ' unicast-address none')]"
},
"Yes": {
"first": "[concat('tmsh modify cm device ', concat(variables('instanceName'), '0.', variables('location'), '.cloudapp.azure.com'), ' unicast-address { { ip ', variables('intSubnetPrivateAddress'), ' port 1026 } } mirror-ip ', variables('intSubnetPrivateAddress'))]",
"second": "[concat('tmsh modify cm device ', concat(variables('instanceName'), '1.', variables('location'), '.cloudapp.azure.com'), ' unicast-address { { ip ', variables('intSubnetPrivateAddress1'), ' port 1026 } } mirror-ip ', variables('intSubnetPrivateAddress1'))]"
}
{% endif %}
{% endset %}
{% if environment == 'azure' %}
{% set compute_api_version = "2017-12-01" %}
{% set auth_api_version = "2018-07-01" %}
{% set deploy_api_version = "2017-05-10" %}
{% set network_api_version = "2018-07-01" %}
{% set storage_api_version = "2017-10-01" %}
{% elif environment == 'azurestack' %}
{% set compute_api_version = "2015-06-15" %}
{% set network_api_version = "2015-06-15" %}
{% set storage_api_version = "2015-06-15" %}
{% endif %}
{% set vm_scale_set_min_count %}
{% if license_type == 'bigiq-payg' %}
0,
{% endif %}
1,
2,
3,
4,
5,
6
{%- endset %}
{% set vm_scale_set_max_count %}
{% if license_type == 'bigiq-payg' %}
1,
{% endif %}
2,
3,
4,
5,
6,
7,
8
{%- endset %}
{% set number_of_external_ips %}
0,
1,
2,
3,
4,
5,
6,
7,
8,
9,
10,
11,
12,
13,
14,
15,
16,
17,
18,
19,
20
{%- endset %}


{%- set instance_type_list -%}

{%- if nics in ('3', 'n') and (type != 'bigiq') -%}
"Standard_A3",
"Standard_A4",
"Standard_A5",
"Standard_A6",
"Standard_A7",
"Standard_D3",
"Standard_D4",
"Standard_D11",
"Standard_D12",
"Standard_D13",
"Standard_D14",
"Standard_DS3",
"Standard_DS4",
"Standard_DS11",
"Standard_DS12",
"Standard_DS13",
"Standard_DS14",
"Standard_D3_v2",
"Standard_D4_v2",
"Standard_D5_v2",
"Standard_D11_v2",
"Standard_D12_v2",
"Standard_D13_v2",
"Standard_D14_v2",
"Standard_D15_v2",
"Standard_DS3_v2",
"Standard_DS4_v2",
"Standard_DS5_v2",
"Standard_DS11_v2",
"Standard_DS12_v2",
"Standard_DS13_v2",
"Standard_DS14_v2",
"Standard_DS15_v2",
"Standard_F4",
"Standard_F8",
"Standard_F4S",
"Standard_F8S",
"Standard_F16S",
"Standard_G3",
"Standard_G4",
"Standard_G5",
"Standard_GS3",
"Standard_GS4",
"Standard_GS5"
{%- elif solution == "waf" and (type != 'bigiq') -%}
"Standard_A3",
"Standard_A4",
"Standard_A5",
"Standard_A6",
"Standard_A7",
"Standard_D2",
"Standard_D3",
"Standard_D4",
"Standard_D11",
"Standard_D12",
"Standard_D13",
"Standard_D14",
"Standard_DS2",
"Standard_DS3",
"Standard_DS4",
"Standard_DS11",
"Standard_DS12",
"Standard_DS13",
"Standard_DS14",
"Standard_D2_v2",
"Standard_D3_v2",
"Standard_D4_v2",
"Standard_D5_v2",
"Standard_D11_v2",
"Standard_D12_v2",
"Standard_D13_v2",
"Standard_D14_v2",
"Standard_D15_v2",
"Standard_DS2_v2",
"Standard_DS3_v2",
"Standard_DS4_v2",
"Standard_DS5_v2",
"Standard_DS11_v2",
"Standard_DS12_v2",
"Standard_DS13_v2",
"Standard_DS14_v2",
"Standard_DS15_v2",
"Standard_F4",
"Standard_F8",
"Standard_F2S",
"Standard_F4S",
"Standard_F8S",
"Standard_F16S",
"Standard_G2",
"Standard_G3",
"Standard_G4",
"Standard_G5",
"Standard_GS2",
"Standard_GS3",
"Standard_GS4",
"Standard_GS5"
{%- elif type == 'bigiq' -%}
"Standard_D4s_v3",
"Standard_D8s_v3"
{%- else -%}
"Standard_A2",
"Standard_A3",
"Standard_A4",
"Standard_A5",
"Standard_A6",
"Standard_A7",
"Standard_D2",
"Standard_D3",
"Standard_D4",
"Standard_D11",
"Standard_D12",
"Standard_D13",
"Standard_D14",
"Standard_DS2",
"Standard_DS3",
"Standard_DS4",
"Standard_DS11",
"Standard_DS12",
"Standard_DS13",
"Standard_DS14",
"Standard_D2_v2",
"Standard_D3_v2",
"Standard_D4_v2",
"Standard_D5_v2",
"Standard_D11_v2",
"Standard_D12_v2",
"Standard_D13_v2",
"Standard_D14_v2",
"Standard_D15_v2",
"Standard_DS2_v2",
"Standard_DS3_v2",
"Standard_DS4_v2",
"Standard_DS5_v2",
"Standard_DS11_v2",
"Standard_DS12_v2",
"Standard_DS13_v2",
"Standard_DS14_v2",
"Standard_DS15_v2",
"Standard_F2",
"Standard_F4",
"Standard_F8",
"Standard_F2S",
"Standard_F4S",
"Standard_F8S",
"Standard_F16S",
"Standard_G2",
"Standard_G3",
"Standard_G4",
"Standard_G5",
"Standard_GS2",
"Standard_GS3",
"Standard_GS4",
"Standard_GS5"
{%- endif -%}
{%- endset -%}
{%- set default_instance_type -%}
{% if nics in ('3', 'n') or (type == 'failover' and lb_method == 'api') -%}
"Standard_DS3_v2"
{% elif type == 'bigiq' %}
"Standard_D4s_v3"
{%- else %}
"Standard_DS2_v2"
{%- endif %}
{%- endset %}

{% set big_ip_versions -%}
"15.1.201000",
"14.1.003000",
"latest"
{%- endset %}
{%- set big_ip_version_default %}
"15.1.201000"
{%- endset %}

{% set big_iq_versions -%}
"6.1.000000"
{%- endset %}
{%- set big_iq_version_default %}
"6.1.000000"
{%- endset %}

{%- set product -%}
{%- if type == 'bigiq' -%}
BIG-IQ
{%- else -%}
BIG-IP
{%- endif -%}
{%- endset -%}

{%- set init_script -%}
"IyEvYmluL2Jhc2gKCiMjIyBDb25maWd1cmUgZGVmYXVsdCB2YWx1ZXMKbG9nX2xldmVsPSJpbmZvIgpoZWxwPWZhbHNlCnNraXBfdmVyaWZ5PWZhbHNlCnNjcmlwdF9kaXI9JChkaXJuYW1lICQwKQoKClRNU0g9L3Vzci9iaW4vdG1zaApDVVJMPS91c3IvYmluL2N1cmwKTk9ERT0vdXNyL2Jpbi9ub2RlCk1LRElSPS9iaW4vbWtkaXIKTU9VTlQ9L2Jpbi9tb3VudApSTURJUj0vYmluL3JtZGlyClVNT1VOVD0vYmluL3Vtb3VudAoKIyMjIEZ1bmN0aW9ucyAtIFRoZXNlIHNob3VsZCBnbyBpbnRvIHNlcGVyYXRlIGZpbGUocykKIyB1c2FnZTogbG9nIG1lc3NhZ2UKZnVuY3Rpb24gbG9nKCkgewogICAgZWNobyAiJChkYXRlICcrJVktJW0tJWRUJUg6JU06JVNaJyk6ICQxIgp9CiMgdXNhZ2U6IGdldF92ZXJzaW9uCmZ1bmN0aW9uIGdldF92ZXJzaW9uKCkgewogICAgcmV0PSQoJFRNU0ggc2hvdyBzeXMgdmVyc2lvbiB8IGdyZXAgLWkgcHJvZHVjdCB8IGF3ayAne3ByaW50ICQyfScpCiAgICBlY2hvICR7cmV0LCx9Cn0KIyB1c2FnZToganNvbmlmeSBrZXk6dmFsdWUsa2V5MTp2YWx1ZTEKZnVuY3Rpb24ganNvbmlmeSgpIHsKICAgIGxpc3Q9JChlY2hvICQxIHwgdHIgJywnICcgJykKICAgIGpzb249J3t9JwogICAgZm9yIGkgaW4gJGxpc3QgOyBkbwogICAgICAgIGt2PSgkKGVjaG8gJGkgfCB0ciAnOicgJyAnKSkKICAgICAgICBqc29uPSQoZWNobyAkanNvbiB8IGpxIC0tYXJnIGsgJHtrdlswXX0gLS1hcmcgdiAke2t2WzFdfSAnLiB8IC5bJGtdPSR2JykKICAgIGRvbmUKICAgIGVjaG8gJGpzb24KfQojIHVzYWdlOiBnZXRfdmFsIGpzb25fb2JqZWN0IGtleQpmdW5jdGlvbiBnZXRfdmFsKCkgewogICAgcmV0PSQoZWNobyAkMSB8IGpxIC4kMiAtcikKICAgIGVjaG8gJHJldAp9CiMgdXNhZ2U6IG1ha2Ugc3VyZSB0aGVyZSBpcyBpbnRlcm5ldCBjb25uZWN0aW9uIHRvIEdpdEh1YgpmdW5jdGlvbiBjaGVja19pbnRlcm5ldF9jb25uZWN0aW9uIHsKICAgIGVjaG8gIi0tLSBDaGVja2luZyBHaXRodWIgc3RhdHVzIC0tLSIKICAgIGNoZWNrcz0wCiAgICBnaXRodWJfcmVzcG9uc2U9ImJhZCIKICAgIHdoaWxlIFsgJGNoZWNrcyAtbHQgMTIwIF0gOyBkbwogICAgICAgIGdpdGh1Yl9yZXNwb25zZT1gY3VybCBodHRwczovL3d3dy5naXRodWJzdGF0dXMuY29tL2FwaS92Mi9zdGF0dXMuanNvbiB8IGpxIC5zdGF0dXMuZGVzY3JpcHRpb24gLS1yYXctb3V0cHV0YAogICAgICAgIGlmIFsgIiRnaXRodWJfcmVzcG9uc2UiID09ICJBbGwgU3lzdGVtcyBPcGVyYXRpb25hbCIgXTsgdGhlbgogICAgICAgICAgICBsb2cgIkdpdEh1YiBpcyByZWFkeSIKICAgICAgICAgICAgYnJlYWsKICAgICAgICBmaQogICAgICAgIGxvZyAiR2l0SHViIG5vdCByZWFkeTogJGNoZWNrcyIKICAgICAgICBsZXQgY2hlY2tzPWNoZWNrcysxCiAgICAgICAgc2xlZXAgNQogICAgZG9uZQogICAgaWYgWyAiJGdpdGh1Yl9yZXNwb25zZSIgPT0gImJhZCIgXTsgdGhlbgogICAgICAgIGxvZyAiTm8gR2l0SHViIGludGVybmV0IGNvbm5lY3Rpb24uIgogICAgICAgIGV4aXQKICAgIGZpCn0KIyB1c2FnZTogbWNwX3J1bm5pbmcKZnVuY3Rpb24gbWNwX3J1bm5pbmcgewogICAgY2hlY2tzPTAKICAgIHdoaWxlIFsgJGNoZWNrcyAtbHQgMTIwIF0gOyBkbwogICAgICAgICRUTVNIIC1hIHNob3cgc3lzIG1jcC1zdGF0ZSBmaWVsZC1mbXQgfCBncmVwIC1xIHJ1bm5pbmcKICAgICAgICBpZiBbICQ/ID09IDAgXTsgdGhlbgogICAgICAgICAgICBsb2cgIk1DUEQgcmVhZHkiCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZmkKICAgICAgICBsb2cgIk1DUEQgbm90IHJlYWR5OiAkY2hlY2tzIgogICAgICAgIGxldCBjaGVja3M9Y2hlY2tzKzEKICAgICAgICBzbGVlcCA1CiAgICBkb25lCn0KIyB1c2FnZTogRG93bmxvYWQgZnJvbSBHaXRodWIgdW50aWwgc3VjY2Vzc2Z1bAojCiMgJDE6IG91dHB1dCBmaWxlIG5hbWUKIyAkMjogVVJMCmZ1bmN0aW9uIHNhZmVfZG93bmxvYWQgewogICAgY2hlY2tzPTAKICAgIHdoaWxlIFsgJGNoZWNrcyAtbHQgMTIwIF0gOyBkbwogICAgICAgICRDVVJMIC0tZmFpbCAtLXJldHJ5IDIwIC0tcmV0cnktZGVsYXkgNSAtLXJldHJ5LW1heC10aW1lIDI0MCAtbyAkMSAkMiAmJiBicmVhawogICAgICAgIGxldCBjaGVja3M9Y2hlY2tzKzEKICAgICAgICBzbGVlcCA1CiAgICBkb25lCn0KIyB1c2FnZTogYmFzZV9jb25maWdfYXZhaWxhYmxlIC0gcmVzb2x2ZXMgaXNzdWUgZm91bmQgaW4gNi4wLjAgdmVyc2lvbnMgb2YgYmlnLWlxCmZ1bmN0aW9uIGJhc2VfY29uZmlnX2F2YWlsYWJsZSB7CiAgICBjaGVja3M9MAogICAgd2hpbGUgWyAkY2hlY2tzIC1sdCAxMjAgXSA7IGRvCiAgICAgICAgJFRNU0ggLWEgc2hvdyBzeXMgbWNwLXN0YXRlIGZpZWxkLWZtdCB8IGdyZXAgLXEgcnVubmluZwogICAgICAgIGlmIFsgLWYgL2NvbmZpZy9iaWdpcF9iYXNlLmNvbmYgXTsgdGhlbgogICAgICAgICAgICBsb2cgIkJhc2UgQ29uZmlnIGZpbGUgcHJlc2VudDsgc2F2aW5nIGNvbmZpZyIKICAgICAgICAgICAgdG1zaCBzYXZlIHN5cyBjb25maWcKICAgICAgICAgICAgY2F0IC9jb25maWcvYmlnaXBfYmFzZS5jb25mCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZmkKICAgICAgICBsb2cgIkJhc2UgY29uZmlnIGZpbGUgbm90IHlldCBwcmVzZW50OiAkY2hlY2tzIgogICAgICAgIGxldCBjaGVja3M9Y2hlY2tzKzEKICAgICAgICBzbGVlcCA1CiAgICBkb25lCn0KIyB1c2FnZTogZ2V0X25ldF9pbmZvIGV0aDAgbnN8Z3cgaW5jbHVkZV9jaWRyCmZ1bmN0aW9uIGdldF9uZXRfaW5mbygpIHsKICAgIFJFVD0iIgogICAgQ0lEUl9CTE9DSz0iIgogICAgaWYgW1sgJGNsb3VkID09ICJhenVyZSIgXV07IHRoZW4KICAgICAgICBhZGRfaW50PTEKICAgICAgICBJRl9NQUM9JChpZmNvbmZpZyAkMSB8IGdyZXAgLWkgaHdhZGRyIHwgYXdrICd7cHJpbnQgJDV9JyB8IHNlZCAncy86Ly9nJykKICAgICAgICBJRl9JTkZPPSQoY3VybCAtc2YgLS1yZXRyeSAyMCBjdXJsIC1IIE1ldGFkYXRhOnRydWUgImh0dHA6Ly8xNjkuMjU0LjE2OS4yNTQvbWV0YWRhdGEvaW5zdGFuY2UvbmV0d29yay9pbnRlcmZhY2U/YXBpLXZlcnNpb249MjAxNy0wOC0wMSIgfCBqcSAnLltdIHwgc2VsZWN0KC5tYWNBZGRyZXNzPT0iJyR7SUZfTUFDfSciKScpCiAgICAgICAgQ0lEUl9CTE9DSz0kKGVjaG8gJHtJRl9JTkZPfSB8IGpxIC5pcHY0LnN1Ym5ldFswXS5hZGRyZXNzIC0tcmF3LW91dHB1dCkKICAgICAgICBDSURSX0JMT0NLKz0iLyIKICAgICAgICBDSURSX0JMT0NLKz0kKGVjaG8gJHtJRl9JTkZPfSB8IGpxIC5pcHY0LnN1Ym5ldFswXS5wcmVmaXggLS1yYXctb3V0cHV0KQogICAgZWxpZiBbWyAkY2xvdWQgPT0gImF3cyIgXV07IHRoZW4KICAgICAgICBjaWRyX2Jsb2NrX3VyaT0idnBjLWlwdjQtY2lkci1ibG9jayIKICAgICAgICBhZGRfaW50PTIKICAgICAgICAjIElmIGdldHRpbmcgZ2F0ZXdheSwgdXBkYXRlIG5lY2Vzc2FyeSB2YXJzCiAgICAgICAgaWYgW1sgJDIgPT0gImd3IiBdXSA7IHRoZW4gY2lkcl9ibG9ja191cmk9InN1Ym5ldC1pcHY0LWNpZHItYmxvY2siIDsgYWRkX2ludD0xIDsgZmkKICAgICAgICBJRl9NQUM9JChpZmNvbmZpZyAkMSB8IGdyZXAgLWkgaHdhZGRyIHwgYXdrICd7cHJpbnQgdG9sb3dlcigkNSl9JykKICAgICAgICBDSURSX0JMT0NLPSQoY3VybCAtc2YgLS1yZXRyeSAyMCBodHRwOi8vMTY5LjI1NC4xNjkuMjU0L2xhdGVzdC9tZXRhLWRhdGEvbmV0d29yay9pbnRlcmZhY2VzL21hY3MvJHtJRl9NQUN9LyR7Y2lkcl9ibG9ja191cml9KQogICAgZmkKICAgIFJFVD0kKGVjaG8gJHtDSURSX0JMT0NLJS8qfSB8IGF3ayAtRi4gJ3sgcHJpbnRmICIlZC4lZC4lZC4lZCIsICQxLCAkMiwgJDMsICQ0Kycke2FkZF9pbnR9JyB9JykKICAgICMgSW5jbHVkZSBtYXNrIGluIHJlc3BvbnNlIGlmIHJlcXVlc3RlZAogICAgaWYgW1sgLW4gIiQzIiBdXSA7IHRoZW4gZWNobyAke1JFVH0vJHtDSURSX0JMT0NLIyovfSA7IGVsc2UgZWNobyAkUkVUIDsgZmkKfQojIGNyZWF0ZXMgYSBkaXJlY3RvcnkgZm9yIGluLW1lbW9yeSBmaWxlcwojIHVzYWdlOiBjcmVhdGVfdGVtcF9kaXIgbmFtZSBzaXplCmZ1bmN0aW9uIGNyZWF0ZV90ZW1wX2RpcigpIHsKICAgICRNS0RJUiAiJDEiCiAgICAkTU9VTlQgLXQgdG1wZnMgLW8gc2l6ZT0iJDIiLG1vZGU9MTcwMCB0bXBmcyAiJDEiCn0KIyB1c2FnZTogcmVtb3ZlX3RlbXBfZGlyIG5hbWUKZnVuY3Rpb24gcmVtb3ZlX3RlbXBfZGlyKCkgewogICAgJFVNT1VOVCAiJDEiCiAgICAkUk1ESVIgIiQxIgp9CiMgdXNhZ2U6IHdpcGVfdGVtcF9kaXIgbmFtZQpmdW5jdGlvbiB3aXBlX3RlbXBfZGlyKCkgewogICAgRklMRVM9JChscyAtMSAiJDEiKQoKICAgIGZvciBmIGluICRGSUxFUzsgZG8KICAgICAgICBzaHJlZCAtLXJlbW92ZSAiJHsxfS8ke2Z9IgogICAgZG9uZQoKICAgIHJlbW92ZV90ZW1wX2RpciAiJDEiCn0KCnJlYWQgLXIgLWQgJycgVVNBR0UgPDwgRU9NCiAgICBVc2FnZTogJDAKICAgICAgICAtLWhlbHAgICAgICAgICAgICAgICAgICAgICAgUHJpbnQgdXNhZ2UgbWVzc2FnZSBhbmQgZXhpdAogICAgICAgIC0tbG9nLWxldmVsIDxzdHJpbmc+ICAgICAgICBMZXZlbCBvZiBsb2dnaW5nIGRlc2lyZWQ6IGVycm9yLCB3YXJuLCBpbmZvLCBkZWJ1ZwogICAgICAgIC0tY2xvdWQgPHN0cmluZz4gICAgICAgICAgICBDbG91ZCBlbnZpcm9ubWVudCBleGVjdXRlZCBhZ2FpbnN0OiBhd3MKICAgICAgICAtLXNraXAtdmVyaWZ5IDxzdHJpbmc+ICAgICAgU2tpcCB2ZXJpZmljYXRpb24gb2YgZGVwZW5kZW5jaWVzCiAgICAgICAgLS1saWNlbnNlIDxzdHJpbmc+ICAgICAgICAgIExpY2Vuc2UgZm9yIHRoZSBkZXZpY2UKICAgICAgICAtLW50cCA8c3RyaW5nPiAgICAgICAgICAgICAgTlRQIGZvciB0aGUgZGV2aWNlCiAgICAgICAgLS10aW1lem9uZSA8c3RyaW5nPiAgICAgICAgIFRpbWV6b25lIGZvciB0aGUgZGV2aWNlCiAgICAgICAgLS1kYXRhLWludGVyZmFjZSA8c3RyaW5nPiAgIFByaW1hcnkgaW50ZXJmYWNlIHRvIHVzZSBmb3IgZGF0YS1wbGFuZQogICAgICAgIC0tdmxhbiA8c3RyaW5nPiAgICAgICAgICAgICBWTEFOKHMpIHRvIGNyZWF0ZSBvbiB0aGUgZGV2aWNlICg7IGZvciBtdWx0aXBsZSkgJ246ZXh0LG5pYzoxLjEnCiAgICAgICAgLS1zZWxmLWlwIDxzdHJpbmc+ICAgICAgICAgIFNlbGYgSVAocykgdG8gY3JlYXRlIG9uIHRoZSBkZXZpY2UgKDsgZm9yIG11bHRpcGxlKTogJ246ZXh0LGE6eC54LngueCx2OmV4dCxpOmV0aDEnCiAgICAgICAgLS11c2FnZS1hbmFseXRpY3MgPHN0cmluZz4gIFVzYWdlIGFuYWx5dGljcyB0byBzZW5kOiAnY046dmFsLHI6dmFsLGNJOnZhbCxkSTp2YWwsbFQ6dmFsLGJJVjp2YWwsdE46dmFsLHRWOnZhbCxzZW5kOnllcycKICAgICAgICAtLWNyZWF0ZS1saWNlbnNlLXBvb2wgICAgICAgQ3JlYXRlcyBsaWNlbnNlIHBvb2wsIHNlbmQ6IG5hbWU6cmVnX2tleQogICAgICAgIC0tY3JlYXRlLXJlZy1rZXktcG9vbCAgICAgICBDcmVhdGVzIGEgcmVna2V5IHBvb2wsIHNlbmQ6IG5hbWU6cmVnX2tleV9saXN0CiAgICAgICAgLS1mY2wtdGFnICAgICAgICAgICAgICAgICAgIEY1IGNsb3VkIGxpYiB0YWcgdG8gZG93bmxvYWQgZjUtY2xvdWQtbGlicy50YXIuZ3oKICAgICAgICAtLWZjbC1jbG91ZC10YWcgICAgICAgICAgICAgRjUgc3BlY2lmaWVkIGNsb3VkIHRhZyB0byBkb3dubG9hZCBmNS1jbG91ZC1saWJzLTxjbG91ZD4udGFyLmd6CiAgICAgICAgLS1iaWctaXEtcGFzc3dvcmQgICAgICAgICAgIEJpZ2lxIHBhc3N3b3JkLCB1c2VkIHRvIG9uYm9hcmQgYmlnaXEgY2x1c3RlcnMKICAgICAgICAtLWJpZy1pcS1tYXN0ZXIta2V5ICAgICAgICAgQmlnLUlRIG1hc3RlcmtleSB1c2VkIGR1cmluZyBpbml0aXRpYWwgY29uZmlndXJhaXRvbgogICAgICAgIC0tYmlnLWlxLXBhc3N3b3JkLWRhdGEtdXJpICBVUkkgdG8gdGhlIGxvY2F0aW9uIHRoYXQgY29udGFpbnMgQklHLUlRIGFkbWluIHVzZXIgcGFzc3dvcmQKICAgICAgICAtLW1hc3RlciAgICAgICAgICAgICAgICAgICAgSW5kaWNhdGVzIHRoYXQgdGhpcyBpbnN0YW5jZSBpcyBtYXN0ZXIgKHVzZWQgaW4gQklHLUlRIGNsdXN0ZXJpbmcpIHVzZSB3aXRoIC0tYmlnLWlxLWZhaWxvdmVyLXBlZXItaXAgb3B0aW9uCiAgICAgICAgLS1iaWctaXEtZmFpbG92ZXItcGVlci1pcCAgIFRoaXMgaXMgdGhlIHByaXZhdGUgSVAgYWRkcmVzcyBmb3IgdGhlIHNlY29uZGFyeSBCSUctSVEKICAgICAgICAtLXRhZy12YWx1ZSAgICAgICAgICAgICAgICAgVGhlIHRhZyB2YWx1ZSB0byBhZGQgdG8gdGhlIEVsYXN0aWMgdmlydHVhbCBJUCBhZGRyZXNzCiAgICAgICAgLS12aXAtYWxsb2NhdGlvbi1pZCAgICAgICAgIEFsbG9jYXRpb24gSUQgb2YgdGhlIEVsYXN0aWMgdmlydHVhbCBJUCBhZGRyZXNzCiAgICAgICAgLS1wcml2YXRlLWlwICAgICAgICAgICAgICAgIFByaXZhdGUgSVAgYWRkcmVzcyBhc3NvY2lhdGVkIHdpdGggdGhlIEVsYXN0aWMgdmlydHVhbCBJUCBhZGRyZXNzCiAgICAgICAgLS1hc3NvY2lhdGUtZW5pICAgICAgICAgICAgIEVOSSBvZiB0aGUgbmV0d29yayBpbnRlcmZhY2UgdG8gYXNzb2NpYXRlIHRoZSBFbGFzdGljIHZpcnR1YWwgSVAgYWRkcmVzcyB3aXRoIGluIEFXUwogICAgICAgIC0tYXNzb2NpYXRlLWludGYgICAgICAgICAgICBOYW1lIG9mIHRoZSBuZXR3b3JrIGludGVyZmFjZSB0byBhc3NvY2lhdGUgdGhlIHZpcnR1YWwgSVAgYWRkcmVzcyB3aXRoIGluIEF6dXJlCiAgICAgICAgLS1kaXNzb2NpYXRlLWludGYgICAgICAgICAgIE5hbWUgb2YgdGhlIG5ldHdvcmsgaW50ZXJmYWNlIHRvIGRpc3NvY2lhdGUgdGhlIHZpcnR1YWwgSVAgYWRkcmVzcyBmcm9tIGluIEF6dXJlCgoKRU9NCgojIyMgUGFyc2UgY29tbWFuZCBsaW5lIGFyZ3VtZW50cwp3aGlsZSBbWyAkIyAtZ3QgMCBdXSA7IGRvCiAgICBjYXNlICIkMSIgaW4KICAgICAgICAtLWhlbHApCiAgICAgICAgICAgIGhlbHA9dHJ1ZQogICAgICAgICAgICBzaGlmdCA7OwogICAgICAgIC0tbG9nLWxldmVsKQogICAgICAgICAgICBsb2dfbGV2ZWw9IiQyIgogICAgICAgICAgICBzaGlmdCAyIDs7CiAgICAgICAgLS1jbG91ZCkKICAgICAgICAgICAgY2xvdWQ9IiQyIgogICAgICAgICAgICBzaGlmdCAyIDs7CiAgICAgICAgLS1za2lwLXZlcmlmeSkKICAgICAgICAgICAgc2tpcF92ZXJpZnk9dHJ1ZQogICAgICAgICAgICBzaGlmdCA7OwogICAgICAgIC0tbGljZW5zZSkKICAgICAgICAgICAgbGljZW5zZT0iJDIiCiAgICAgICAgICAgIHNoaWZ0IDIgOzsKICAgICAgICAtLW50cCkKICAgICAgICAgICAgbnRwPSIkMiIKICAgICAgICAgICAgc2hpZnQgMiA7OwogICAgICAgIC0tdGltZXpvbmUpCiAgICAgICAgICAgIHRpbWV6b25lPSIkMiIKICAgICAgICAgICAgc2hpZnQgMiA7OwogICAgICAgIC0tZGF0YS1pbnRlcmZhY2UpCiAgICAgICAgICAgIGRhdGFfaW50ZXJmYWNlPSIkMiIKICAgICAgICAgICAgc2hpZnQgMiA7OwogICAgICAgIC0tdXNhZ2UtYW5hbHl0aWNzKQogICAgICAgICAgICB1c2FnZV9hbmFseXRpY3M9IiQyIgogICAgICAgICAgICBzaGlmdCA7OwogICAgICAgIC0tdmxhbikKICAgICAgICAgICAgdmxhbj0iJDIiCiAgICAgICAgICAgIHNoaWZ0IDIgOzsKICAgICAgICAtLXNlbGYtaXApCiAgICAgICAgICAgIHNlbGZfaXA9IiQyIgogICAgICAgICAgICBzaGlmdCAyIDs7CiAgICAgICAgLS1kaXNjb3ZlcnktYWRkcmVzcykKICAgICAgICAgICAgZGlzY292ZXJ5X2FkZHJlc3M9IiQyIgogICAgICAgICAgICBzaGlmdCAyIDs7CiAgICAgICAgLS1jcmVhdGUtbGljZW5zZS1wb29sKQogICAgICAgICAgICBsaWNlbnNlX3Bvb2w9IiQyIgogICAgICAgICAgICBzaGlmdCAyIDs7CiAgICAgICAgLS1jcmVhdGUtcmVnLWtleS1wb29sKQogICAgICAgICAgICByZWdfa2V5X3Bvb2w9IiQyIgogICAgICAgICAgICBzaGlmdCAyIDs7CiAgICAgICAgLS1mY2wtdGFnKQogICAgICAgICAgICBmY2xfdGFnPSIkMiIKICAgICAgICAgICAgc2hpZnQgMiA7OwogICAgICAgIC0tZmNsLWNsb3VkLXRhZykKICAgICAgICAgICAgZmNsX2Nsb3VkX3RhZz0iJDIiCiAgICAgICAgICAgIHNoaWZ0IDIgOzsKICAgICAgICAtLWJpZy1pcS1wYXNzd29yZCkKICAgICAgICAgICAgYmlnaXFfcGFzc3dvcmQ9IiQyIgogICAgICAgICAgICBzaGlmdCAyIDs7CiAgICAgICAgLS1iaWctaXEtbWFzdGVyLWtleSkKICAgICAgICAgICAgYmlnaXFfbWFzdGVyX2tleT0iJDIiCiAgICAgICAgICAgIHNoaWZ0IDIgOzsgICAgICAgICAgICAgICAgCiAgICAgICAgLS1iaWctaXEtcGFzc3dvcmQtZGF0YS11cmkpCiAgICAgICAgICAgIHBhc3N3b3JkX2RhdGFfdXJpPSIkMiIKICAgICAgICAgICAgc2hpZnQgMiA7OwogICAgICAgIC0tbWFzdGVyKQogICAgICAgICAgICBtYXN0ZXI9dHJ1ZQogICAgICAgICAgICBzaGlmdCA7OwogICAgICAgIC0tYmlnLWlxLWZhaWxvdmVyLXBlZXItaXApCiAgICAgICAgICAgIGJpZ19pcV9mYWlsb3Zlcl9wZWVyX2lwPSIkMiIKICAgICAgICAgICAgc2hpZnQgMiA7OwogICAgICAgIC0tdGFnLXZhbHVlKQogICAgICAgICAgICB0YWdfdmFsdWU9IiQyIgogICAgICAgICAgICBzaGlmdCAyIDs7CiAgICAgICAgLS12aXAtYWxsb2NhdGlvbi1pZCkKICAgICAgICAgICAgdmlwX2FsbG9jYXRpb25faWQ9IiQyIgogICAgICAgICAgICBzaGlmdCAyIDs7CiAgICAgICAgLS1wcml2YXRlLWlwKQogICAgICAgICAgICBwcml2YXRlX2lwPSIkMiIKICAgICAgICAgICAgc2hpZnQgMiA7OwogICAgICAgIC0tYXNzb2NpYXRlLWVuaSkKICAgICAgICAgICAgYXNzb2NpYXRlX2VuaT0iJDIiCiAgICAgICAgICAgIHNoaWZ0IDIgOzsKICAgICAgICAtLWFzc29jaWF0ZS1pbnRmKQogICAgICAgICAgICBhc3NvY2lhdGVfaW50Zj0iJDIiCiAgICAgICAgICAgIHNoaWZ0IDIgOzsKICAgICAgICAtLWRpc3NvY2lhdGUtaW50ZikKICAgICAgICAgICAgZGlzc29jaWF0ZV9pbnRmPSIkMiIKICAgICAgICAgICAgc2hpZnQgMiA7OwogICAgICAgICp8LS0pCiAgICAgICAgICAgIHNoaWZ0CiAgICAgICAgICAgIGJyZWFrIDs7CiAgICBlc2FjCmRvbmUKCmlmICRoZWxwIDsgdGhlbgogICAgZWNobyAiJFVTQUdFIgogICAgZXhpdApmaQoKIyBWZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVycwpyZXF1aXJlZD0oImNsb3VkIikKZm9yIGkgaW4gJHtyZXF1aXJlZFtAXX0gOyBkbwogICAgaWYgWyAteiAkeyFpfSBdIDsgdGhlbgogICAgICAgIGxvZyAiQSByZXF1aXJlZCBwYXJhbWV0ZXIgaXMgbWlzc2luZzogJGkiCiAgICAgICAgZXhpdAogICAgZmkKZG9uZQoKY29uZmlnX3BhcmFtcz0iLS1oZWxwICRoZWxwIC0tbG9nLWxldmVsICRsb2dfbGV2ZWwgLS1jbG91ZCAkY2xvdWQgLS1za2lwLXZlcmlmeSAkc2tpcF92ZXJpZnkgLS1saWNlbnNlICRsaWNlbnNlIC0tbnRwICRudHAgLS10aW1lem9uZSAkdGltZXpvbmUgIC0tZGF0YS1pbnRlcmZhY2UgJGRhdGFfaW50ZXJmYWNlIC0tdXNhZ2UtYW5hbHl0aWNzICR1c2FnZV9hbmFseXRpY3MgLS12bGFuICR2bGFuIC0tc2VsZi1pcCAkc2VsZl9pcCAtLWRpc2NvdmVyeS1hZGRyZXNzICRkaXNjb3ZlcnlfYWRkcmVzcyAtLWNyZWF0ZS1saWNlbnNlLXBvb2wgJGxpY2Vuc2VfcG9vbCAtLWNyZWF0ZS1yZWcta2V5LXBvb2wgJHJlZ19rZXlfcG9vbCAtLWZjbC10YWcgJGZjbF90YWcgLS1mY2wtY2xvdWQtdGFnICRmY2xfY2xvdWRfdGFnICIKCiMgQ2hlY2sgZm9yIGVtcHR5IHZhcnM7IGFkZCB0byBjb25maWdfcGFybXMgaXMgbm90IGVtcHR5CltbICEgLXogIiRtYXN0ZXIiIF1dICYmIGNvbmZpZ19wYXJhbXMrPSIgLS1tYXN0ZXIgJG1hc3RlciAiCltbICEgLXogIiRiaWdpcV9tYXN0ZXJfa2V5IiBdXSAmJiBjb25maWdfcGFyYW1zKz0iIC0tYmlnLWlxLW1hc3Rlci1rZXkgJGJpZ2lxX21hc3Rlcl9rZXkgIgpbWyAhIC16ICIkcGFzc3dvcmRfZGF0YV91cmkiIF1dICYmIGNvbmZpZ19wYXJhbXMrPSIgLS1iaWctaXEtcGFzc3dvcmQtZGF0YS11cmkgJHBhc3N3b3JkX2RhdGFfdXJpICIKW1sgISAteiAiJGJpZ19pcV9mYWlsb3Zlcl9wZWVyX2lwIiBdXSAmJiBjb25maWdfcGFyYW1zKz0iIC0tYmlnLWlxLWZhaWxvdmVyLXBlZXItaXAgJGJpZ19pcV9mYWlsb3Zlcl9wZWVyX2lwICIKZWNobyAiQ29uZmlndXJhdGlvbiBwYXJhbWV0ZXJzOiAke2NvbmZpZ19wYXJhbXMvJGJpZ2lxX21hc3Rlcl9rZXkvT2JmdXNjYXRlZH0iCiMgQ2hlY2sgZm9yICJEbyBOb3QgQ3JlYXRlIiBpbiBjcmVhdGUgcG9vbCBwYXJtZXRlcnMKc2hvcHQgLXMgbm9jYXNlbWF0Y2gKaWYgW1sgJGxpY2Vuc2VfcG9vbCA9PSAiRG9fTm90X0NyZWF0ZSIgXV0gOyB0aGVuCiAgICBsb2cgIlNldHRpbmcgbGljZW5zaW5nIHBvb2wgdG8gbnVsbCBhcyAnRG9fTm90X0NyZWF0ZScgaGFzIGJlZW4gc3BlY2lmaWVkOiAkbGljZW5zaW5nX3Bvb2wiCiAgICBsaWNlbnNlX3Bvb2w9IiIKZmkKaWYgW1sgJHJlZ19rZXlfcG9vbCA9PSAiRG9fTm90X0NyZWF0ZSIgXV0gOyB0aGVuCiAgICBsb2cgIlNldHRpbmcgcmVnIGtleSBwb29sIHRvIG51bGwgYXMgJ0RvX05vdF9DcmVhdGUnIGhhcyBiZWVuIHNwZWNpZmllZDogJGxpY2Vuc2luZ19wb29sIgogICAgcmVnX2tleV9wb29sPSIiCmZpCnNob3B0IC11IG5vY2FzZW1hdGNoCgojIyMgSW5zdGFsbCBkZXBlbmRlbmNpZXMgIyMjCiMjIFRoZXJlIG11c3QgYmUgR2l0SHViIGludGVybmV0IGNvbm5lY3Rpb24KY2hlY2tfaW50ZXJuZXRfY29ubmVjdGlvbgoKYmFzZV91cmw9Imh0dHBzOi8vY2RuLmY1LmNvbS9wcm9kdWN0L2Nsb3Vkc29sdXRpb25zIgpiYXNlX2Rpcj0iL2NvbmZpZy9jbG91ZCIKYmFzZV9sb2dfZGlyPSIvdmFyL2xvZy9jbG91ZC8ke2Nsb3VkfSIKYmFzZV9kZXBlbmRlbmN5X2Rpcj0iJHtiYXNlX2Rpcn0vJHtjbG91ZH0vbm9kZV9tb2R1bGVzL0BmNWRldmNlbnRyYWwiCgojIyBEb3dubG9hZApkZXBlbmRlbmNpZXM9KCIke2Jhc2VfdXJsfS9mNS1jbG91ZC1saWJzLyR7ZmNsX3RhZ30vZjUtY2xvdWQtbGlicy50YXIuZ3oiKQpkZXBlbmRlbmNpZXMrPSgiJHtiYXNlX3VybH0vZjUtY2xvdWQtbGlicy0ke2Nsb3VkfS8ke2ZjbF9jbG91ZF90YWd9L2Y1LWNsb3VkLWxpYnMtJHtjbG91ZH0udGFyLmd6IikKZGVwZW5kZW5jaWVzKz0oIiR7YmFzZV91cmx9L2Y1LWNsb3VkLWxpYnMvJHtmY2xfdGFnfS92ZXJpZnlIYXNoIikKCmZvciBpIGluICR7ZGVwZW5kZW5jaWVzW0BdfSA7IGRvCiAgICBsb2cgIkRvd25sb2FkaW5nIGRlcGVuZGVuY3k6ICRpIgogICAgZj0kKGJhc2VuYW1lICRpKQogICAgc2FmZV9kb3dubG9hZCAke2Jhc2VfZGlyfS8kZiAkaQogICAgIyAkQ1VSTCAta3NmIC0tcmV0cnkgMTAgLS1yZXRyeS1kZWxheSA1IC0tcmV0cnktbWF4LXRpbWUgMjQwIC1vICR7YmFzZV9kaXJ9LyRmICRpCmRvbmUKCiMjIFZlcmlmeQojIE1DUCBtdXN0IGJlIHJ1bm5pbmcgZmlyc3QKbWNwX3J1bm5pbmcKYmFzZV9jb25maWdfYXZhaWxhYmxlCgppZiAhICRza2lwX3ZlcmlmeSA7IHRoZW4KICAgIHZlcmlmeV9zY3JpcHQ9IiR7YmFzZV9kaXJ9L3ZlcmlmeUhhc2giCiAgICBpZiAhICRUTVNIIGxvYWQgc3lzIGNvbmZpZyBtZXJnZSBmaWxlICR2ZXJpZnlfc2NyaXB0IDsgdGhlbgogICAgICAgIGxvZyAiQ0xJIHZlcmlmaWNhdGlvbiBzY3JpcHQgaXMgbm90IHZhbGlkOiAkdmVyaWZ5X3NjcmlwdCIKICAgICAgICBleGl0IDEKICAgIGZpCgogICAgZm9yIGkgaW4gJHtkZXBlbmRlbmNpZXNbQF19IDsgZG8KICAgICAgICBmPSQoYmFzZW5hbWUgJGkpCiAgICAgICAgaWYgW1sgJGYgIT0gInZlcmlmeUhhc2giIF1dIDsgdGhlbgogICAgICAgICAgICBsb2cgIlZlcmlmeWluZyBkZXBlbmRlbmN5OiAkZiIKICAgICAgICAgICAgaWYgISAkVE1TSCBydW4gY2xpIHNjcmlwdCB2ZXJpZnlIYXNoICIvY29uZmlnL2Nsb3VkLyRmIiA7IHRoZW4KICAgICAgICAgICAgICAgIGxvZyAiRGVwZW5kZW5jeSBpcyBub3QgdmFsaWQ6ICRmIgogICAgICAgICAgICAgICAgZXhpdCAxCiAgICAgICAgICAgIGZpCiAgICAgICAgZmkKICAgIGRvbmUKZWxzZQogICAgbG9nICJXYXJuaW5nOiBTa2lwcGluZyBkZXBlbmRlbmN5IHZlcmlmaWNhdGlvbiIKZmkKCiMjIEluc3RhbGwKbWtkaXIgLXAgJGJhc2VfZGVwZW5kZW5jeV9kaXIKZm9yIGkgaW4gJHtkZXBlbmRlbmNpZXNbQF19IDsgZG8KICAgIGY9JChiYXNlbmFtZSAkaSkKICAgIGxvZyAiSW5zdGFsbGluZyBkZXBlbmRlbmN5OiAkZiIKICAgIGlmIFtbICRmID09ICoiLnRhciIqIF1dIDsgdGhlbgogICAgICAgIHRhciB4ZnogJHtiYXNlX2Rpcn0vJHtmfSAtQyAkYmFzZV9kZXBlbmRlbmN5X2RpcgogICAgZmkKZG9uZQoKIyMgU2lnbmFsCnRvdWNoICIke2Jhc2VfZGlyfS9jbG91ZExpYnNSZWFkeSIKCiMgQ3JlYXRlIHRtcCBiaWctaXEgcGFzc3dvcmQgZmlsZS4gUmVxdWlyZWQgZm9yIEF6dXJlIGJpZy1pcSBjbHVzdGVyaW5nLgppZiBbIC1uICIkYmlnaXFfcGFzc3dvcmQiIF0gOyB0aGVuCiAgICBlY2hvICdDcmVhdGluZyBiaWdpcSB0ZW1wb3JhcnkgcGFzc3dvcmQgZmlsZS4nCiAgICB0bXBfZmlsZT0nL21udC9jbG91ZFRtcC8uYmlnaXFfcGFzcycKICAgIHRtcF9kaXI9JChkaXJuYW1lICR0bXBfZmlsZSkKICAgIGNyZWF0ZV90ZW1wX2RpciAkdG1wX2RpcgogICAgZWNobyAieyBcIm1hc3RlclBhc3NwaHJhc2VcIjogXCIke2JpZ2lxX21hc3Rlcl9rZXl9XCIsXCJyb290XCI6IFwiJHtiaWdpcV9wYXNzd29yZH1cIixcImFkbWluXCI6IFwiJHtiaWdpcV9wYXNzd29yZH1cIiB9IiA+ICR0bXBfZmlsZQpmaQojIyMgUHJvdmlzaW9uIERldmljZSAjIyMKbWtkaXIgLXAgJGJhc2VfbG9nX2Rpcgpob3N0bmFtZT0iIgppZiBbWyAkY2xvdWQgPT0gImF3cyIgXV07IHRoZW4KICAgIGhvc3RuYW1lPSQoJENVUkwgLXNmIC0tcmV0cnkgMjAgaHR0cDovLzE2OS4yNTQuMTY5LjI1NC9sYXRlc3QvbWV0YS1kYXRhL2hvc3RuYW1lKQplbGlmIFtbICRjbG91ZCA9PSAiYXp1cmUiIF1dOyB0aGVuCiAgICBtZXRhZGF0YT0kKCRDVVJMIC1IIE1ldGFkYXRhOnRydWUgImh0dHA6Ly8xNjkuMjU0LjE2OS4yNTQvbWV0YWRhdGEvaW5zdGFuY2UvY29tcHV0ZT9hcGktdmVyc2lvbj0yMDE3LTEyLTAxIikKICAgIGhvc3RuYW1lPSQoZWNobyAke21ldGFkYXRhfSB8IGpxIC5uYW1lIC0tcmF3LW91dHB1dCkKICAgIGhvc3RuYW1lKz0iLiIKICAgIGhvc3RuYW1lKz0kKGVjaG8gJHttZXRhZGF0YX0gfCBqcSAubG9jYXRpb24gLS1yYXctb3V0cHV0KQogICAgaG9zdG5hbWUrPSIuY2xvdWRhcHAuYXp1cmUuY29tIgpmaQpob3N0PSJsb2NhbGhvc3QiCnNlcGFyYXRvcj0iOyIKCiMgQ291bGQgdXNlIGEgZ2VuZXJpYyAtLW9uYm9hcmR8LS1uZXR3b3JrfGV0YyBmb3Igb3B0aW9uYWwgYXJndW1lbnRzCiMgaW5zdGVhZCwgYXQgbGVhc3QgZm9yIG5vdyBpbXBsZW1lbnQgdGhlIGFkZGl0aW9uYWwgYWJzdHJhY3Rpb24KCiMjIE9uYm9hcmQKb25ib2FyZF9hcmdzPSIiCmlmIFsgLW4gIiRjbG91ZCIgXSA7IHRoZW4gb25ib2FyZF9hcmdzKz0iLS1jbG91ZCAke2Nsb3VkfSAiIDsgZmkKaWYgWyAtbiAiJGxpY2Vuc2UiIF0gOyB0aGVuIG9uYm9hcmRfYXJncys9Ii0tbGljZW5zZSAke2xpY2Vuc2V9ICIgOyBmaQppZiBbIC1uICIkbnRwIiBdIDsgdGhlbiBvbmJvYXJkX2FyZ3MrPSItLW50cCAke250cH0gIiA7IGZpCmlmIFsgLW4gIiR0aW1lem9uZSIgXSA7IHRoZW4gb25ib2FyZF9hcmdzKz0iLS10eiAke3RpbWV6b25lfSAiIDsgZmkKaWYgWyAtbiAiJGxpY2Vuc2VfcG9vbCIgXSA7IHRoZW4KICAgICMgQ2hlY2sgZm9yIG11bGl0aXBsZSBsaWNlbnNlIHBvb2xzCiAgICBPSUZTPSRJRlMKICAgIElGUz0iLCI7CiAgICBsaWNlbnNlQXJyYXk9KCRsaWNlbnNlX3Bvb2wpOwogICAgZm9yIGkgaW4gJHtsaWNlbnNlQXJyYXlbQF19OyBkbwogICAgICAgIGZsYWc9JyAtLWNyZWF0ZS1saWNlbnNlLXBvb2wgJwogICAgICAgIGNhdF9hcmdzPSIke2NhdF9hcmdzfSR7ZmxhZ30kaSIKICAgIGRvbmUKICAgIElGUz0kT0lGUzsKICAgIG9uYm9hcmRfYXJncys9IiR7Y2F0X2FyZ3N9ICIgOyBmaQoKaWYgWyAtbiAiJHJlZ19rZXlfcG9vbCIgXSA7IHRoZW4gb25ib2FyZF9hcmdzKz0iLS1jcmVhdGUtcmVnLWtleS1wb29sICR7cmVnX2tleV9wb29sfSAiIDsgZmkKCmlmIFtbICRjbG91ZCA9PSAiYXdzIiBdXTsgdGhlbgogICAgaWYgWyAtbiAiJGRhdGFfaW50ZXJmYWNlIiBdIDsgdGhlbiBvbmJvYXJkX2FyZ3MrPSItLWRucyAkKGdldF9uZXRfaW5mbyAkZGF0YV9pbnRlcmZhY2UgbnMpICIgOyBmaQplbGlmIFtbICRjbG91ZCA9PSAiYXp1cmUiIF1dOyB0aGVuCiAgICBpZiBbIC1uICIkZGF0YV9pbnRlcmZhY2UiIF0gOyB0aGVuIG9uYm9hcmRfYXJncys9Ii0tZG5zIDE2OC42My4xMjkuMTYgIiA7IGZpCmZpCgppZiBbWyAiJChnZXRfdmVyc2lvbikiID09ICJiaWctaXEiICYmIC1uICIkcGFzc3dvcmRfZGF0YV91cmkiIF1dOyB0aGVuCiAgICBvbmJvYXJkX2FyZ3MrPSItLWJpZy1pcS1wYXNzd29yZC1kYXRhLXVyaSAke3Bhc3N3b3JkX2RhdGFfdXJpfSAiCmVsaWYgW1sgIiQoZ2V0X3ZlcnNpb24pIiA9PSAiYmlnLWlxIiBdXTsgdGhlbgogICAgb25ib2FyZF9hcmdzKz0iLS1zZXQtbWFzdGVyLWtleSAiCmZpCgppZiBbIC1uICIkdXNhZ2VfYW5hbHl0aWNzIiBdIDsgdGhlbgogICAgbz0kKGpzb25pZnkgJHVzYWdlX2FuYWx5dGljcykKICAgICMgT2JmdXNjYXRlIHNlbnNpdGl2ZSBpbmZvcm1hdGlvbgogICAgY0k9JChlY2hvICQoZ2V0X3ZhbCAiJG8iIGNJKSB8IHNoYTUxMnN1bSB8IGN1dCAtZCAiICIgLWYgMSkKICAgIGRJPSQoZWNobyAkKGdldF92YWwgIiRvIiBkSSkgfCBzaGE1MTJzdW0gfCBjdXQgLWQgIiAiIC1mIDEpCiAgICBtZXRyaWNzKz0iY2xvdWROYW1lOiQoZ2V0X3ZhbCAiJG8iIGNOKSxyZWdpb246JChnZXRfdmFsICIkbyIgciksY3VzdG9tZXJJZDoke2NJfSIKICAgIG1ldHJpY3MrPSIsZGVwbG95bWVudElkOiR7ZEl9LGxpY2Vuc2VUeXBlOiQoZ2V0X3ZhbCAiJG8iIGxUKSxiaWdJcFZlcnNpb246JChnZXRfdmFsICIkbyIgYklWKSIKICAgIG1ldHJpY3MrPSIsdGVtcGxhdGVOYW1lOiQoZ2V0X3ZhbCAiJG8iIHROKSx0ZW1wbGF0ZVZlcnNpb246JChnZXRfdmFsICIkbyIgdFYpICIKICAgIHNlbmRfYW5hbHl0aWNzPSQoZ2V0X3ZhbCAiJG8iIHNlbmQpCiAgICBpZiBbWyAiJHtzZW5kX2FuYWx5dGljcywsfSIgPT0gInllcyIgXV0gOyB0aGVuIG9uYm9hcmRfYXJncys9Ii0tbWV0cmljcyAkbWV0cmljcyAiIDsgZmkKZmkKCiROT0RFICIke2Jhc2VfZGVwZW5kZW5jeV9kaXJ9L2Y1LWNsb3VkLWxpYnMvc2NyaXB0cy9vbmJvYXJkLmpzIiAtLWhvc3QgJGhvc3QgLS1sb2ctbGV2ZWwgJGxvZ19sZXZlbCBcCiAgICAtLW91dHB1dCAiJHtiYXNlX2xvZ19kaXJ9L29uYm9hcmQubG9nIiAtLXNpZ25hbCBPTkJPQVJEX0RPTkUgLS1ob3N0bmFtZSAkaG9zdG5hbWUgJG9uYm9hcmRfYXJncyAmPj4gJHtiYXNlX2xvZ19kaXJ9L2luc3RhbGwubG9nCgojIFRPRE86IFJhY2UgY29uZGl0aW9uIGJldHdlZW4gb25ib2FyZC9uZXR3b3JrIC0gVXNpbmcgYXV0aCB0b2tlbiByZXN1bHRzIGluIDQwMyAibm90IGF1dGhvcml6ZWQiCiMgaWYgbmV0d29yayBjYWxsIGltbWVkaWF0ZWx5IGZvbGxvd3Mgb25ib2FyZC4gIFVzZSBmb2xsb3dpbmcgcGxhY2Vob2xkZXIgdW50aWwgZml4ZWQgaW4gZjUtY2xvdWQtbGlicwojIGFkZGluZyAtLXdhaXQtZm9yIHNpZ25hbCBmb3IgbmV0d29yayBjYWxsLgp3YWl0X3RpbWU9MzAKbG9nICJXYWl0aW5nOiAkd2FpdF90aW1lIgpzbGVlcCAkd2FpdF90aW1lCgojIyBOZXR3b3JrCmVjaG8gIkNvbmZpZ3VyaW5nIG5ldHdvcmsuLi4iCm5ldHdvcmtfYXJncz0iIgppZiBbIC1uICIkZGF0YV9pbnRlcmZhY2UiIF0gOyB0aGVuIG5ldHdvcmtfYXJncys9Ii0tZGVmYXVsdC1ndyAkKGdldF9uZXRfaW5mbyAkZGF0YV9pbnRlcmZhY2UgZ3cpICIgOyBmaQppZiBbIC1uICIkdmxhbiIgXSA7IHRoZW4KICAgIGZvciBpIGluICQoZWNobyAkdmxhbiB8IHRyICIkc2VwYXJhdG9yIiAnICcpIDsgZG8KICAgICAgICBvPSQoanNvbmlmeSAkaSkKICAgICAgICBuZXR3b3JrX2FyZ3MrPSItLXZsYW4gbmFtZTokKGdldF92YWwgIiRvIiBuKSxuaWM6JChnZXRfdmFsICIkbyIgbmljKSAiCiAgICBkb25lCmZpCmlmIFsgLW4gIiRzZWxmX2lwIiBdIDsgdGhlbgogICAgZm9yIGkgaW4gJChlY2hvICRzZWxmX2lwIHwgdHIgIiRzZXBhcmF0b3IiICcgJykgOyBkbwogICAgICAgIG89JChqc29uaWZ5ICRpKQogICAgICAgIGd3PSQoZ2V0X25ldF9pbmZvICQoZ2V0X3ZhbCAiJG8iIGkpIGd3IGNpZHIpCiAgICAgICAgbmV0d29ya19hcmdzKz0iLS1zZWxmLWlwIG5hbWU6JChnZXRfdmFsICIkbyIgbiksYWRkcmVzczokKGdldF92YWwgIiRvIiBhKS8ke2d3IyovfSx2bGFuOiQoZ2V0X3ZhbCAiJG8iIHYpICIKICAgIGRvbmUKZmkKaWYgWyAtbiAiJGRpc2NvdmVyeV9hZGRyZXNzIiBdIDsgdGhlbgogICAgbmV0d29ya19hcmdzKz0iLS1kaXNjb3ZlcnktYWRkcmVzcyAke2Rpc2NvdmVyeV9hZGRyZXNzfSIKZmkKJE5PREUgIiR7YmFzZV9kZXBlbmRlbmN5X2Rpcn0vZjUtY2xvdWQtbGlicy9zY3JpcHRzL25ldHdvcmsuanMiIC0taG9zdCAkaG9zdCAtLWxvZy1sZXZlbCAkbG9nX2xldmVsIFwKICAgIC0tb3V0cHV0ICIke2Jhc2VfbG9nX2Rpcn0vbmV0d29yay5sb2ciIC0td2FpdC1mb3IgT05CT0FSRF9ET05FIC0tc2lnbmFsIE5FVFdPUktfRE9ORSAkbmV0d29ya19hcmdzICY+PiAke2Jhc2VfbG9nX2Rpcn0vaW5zdGFsbC5sb2cKCiMjIEFkZCByb3V0ZSB0byBJbnN0YW5jZSBNZXRhZGF0YSBzZXJ2aWNlCiMgQWxsb3cgc3lzdGVtIHRvIHVzZSBJUHY0IGxpbmstbG9jYWwgYWRkcmVzc2VzIGluIG5ldHdvcmsgcm91dGVzCnRtc2ggbW9kaWZ5IHN5cyBkYiBjb25maWcuYWxsb3cucmZjMzkyNyB2YWx1ZSBlbmFibGUKCiMgQWRkIHJvdXRlIHRvIE1ldGFkYXRhIHNlcnZpY2UKZ2F0ZXdheT0kKHRtc2ggbGlzdCBzeXMgbWFuYWdlbWVudC1yb3V0ZSBnYXRld2F5IHwgZ3JlcCBnYXRld2F5IHwgaGVhZCAtbiAxIHwgYXdrICd7cHJpbnQgJDJ9JykKdG1zaCBjcmVhdGUgc3lzIG1hbmFnZW1lbnQtcm91dGUgbWV0YWRhdGEgbmV0d29yayAxNjkuMjU0LjE2OS4yNTQvMzIgZ2F0ZXdheSAkZ2F0ZXdheQoKIyMgQ2x1c3RlcgppZiBbWyAtbiAiJG1hc3RlciIgJiYgLW4gIiRiaWdfaXFfZmFpbG92ZXJfcGVlcl9pcCIgXV0gOyB0aGVuCiAgICBlY2hvICJDb25maWd1cmluZyBjbHVzdGVyLi4uIgogICAgY2x1c3Rlcl9hcmdzPSItLWNsb3VkICRjbG91ZCAtLW1hc3RlciAtLWJpZy1pcS1mYWlsb3Zlci1wZWVyLWlwICRiaWdfaXFfZmFpbG92ZXJfcGVlcl9pcCIKICAgIGlmIFsgLW4gIiRwYXNzd29yZF9kYXRhX3VyaSIgXSA7IHRoZW4KICAgICAgICBjbHVzdGVyX2FyZ3MrPSIgLS1iaWctaXEtcGFzc3dvcmQtZGF0YS11cmkgJHBhc3N3b3JkX2RhdGFfdXJpICIKICAgIGZpCiAgICAkTk9ERSAiJHtiYXNlX2RlcGVuZGVuY3lfZGlyfS9mNS1jbG91ZC1saWJzL3NjcmlwdHMvY2x1c3Rlci5qcyIgLS1ob3N0ICRob3N0IC0tbG9nLWxldmVsICRsb2dfbGV2ZWwgXAogICAgICAgIC0tb3V0cHV0ICIke2Jhc2VfbG9nX2Rpcn0vY2x1c3Rlci5sb2ciIC0tdXNlciBhZG1pbiAkY2x1c3Rlcl9hcmdzICY+PiAke2Jhc2VfbG9nX2Rpcn0vaW5zdGFsbC5sb2cKZmkKCiMgRmFpbG92ZXIKIyBPbmx5IHBlcmZvcm0gZmFpbG92ZXIgZm9yIGNsdXN0ZXIgc29sdXRpb24KaWYgW1sgLW4gIiR0YWdfdmFsdWUiIF1dIDsgdGhlbgogICAgZmFpbG92ZXJfYXJncz0iLS1sb2ctbGV2ZWwgJGxvZ19sZXZlbCAtLWxvZy1maWxlIC92YXIvbG9nL2Nsb3VkLyRjbG91ZC9mYWlsb3Zlci5sb2cgLS10YWcta2V5IGY1X2RlcGxveW1lbnQgIgogICAgZmFpbG92ZXJfYXJncys9Ii0tdGFnLXZhbHVlICR0YWdfdmFsdWUgIgoKICAgIGlmIFtbICRjbG91ZCA9PSAiYXdzIiBdXTsgdGhlbgogICAgICAgIGlmIFsgLW4gIiR2aXBfYWxsb2NhdGlvbl9pZCIgXSA7IHRoZW4KICAgICAgICBmYWlsb3Zlcl9hcmdzKz0iLS12aXAtYWxsb2NhdGlvbi1pZCAkdmlwX2FsbG9jYXRpb25faWQgIgogICAgICAgIGZpCgogICAgICAgIGlmIFsgLW4gIiRwcml2YXRlX2lwIiBdIDsgdGhlbgogICAgICAgICAgICBmYWlsb3Zlcl9hcmdzKz0iLS1wcml2YXRlLWlwICRwcml2YXRlX2lwICIKICAgICAgICBmaQoKICAgICAgICBpZiBbIC1uICIkYXNzb2NpYXRlX2VuaSIgXSA7IHRoZW4KICAgICAgICAgICAgZmFpbG92ZXJfYXJncys9Ii0tYXNzb2NpYXRlLWVuaSAkYXNzb2NpYXRlX2VuaSAiCiAgICAgICAgZmkKCiAgICAgICAgaWYgWyAtbiAiJHBhc3N3b3JkX2RhdGFfdXJpIiBdIDsgdGhlbgogICAgICAgICAgICBmYWlsb3Zlcl9hcmdzKz0iLS1wYXNzd29yZC11cmkgJHBhc3N3b3JkX2RhdGFfdXJpICIKICAgICAgICBmaQogICAgZmkKCiAgICAjIEF6dXJlIG5lZWRzIGV4dHJhIGNhcmVzOiBhZnRlciBjbHVzdGVyaW5nIGlzIGRvbmUsIGJpZ2lxIHRtcCBwYXNzd29yZCBmaWxlIHdpbGwgYmUgZGVsZXRlZCwgd2UgbmVlZCBiaWdpcSBwYXNzd29yZAogICAgIyB0byBwZXJmb3JtIGZhaWxvdmVyCiAgICBpZiBbWyAkY2xvdWQgPT0gImF6dXJlIiBdXTsgdGhlbgogICAgICAgIGlmIFsgLW4gIiRiaWdpcV9wYXNzd29yZCIgXSA7IHRoZW4KICAgICAgICAgICAgIyMgSWYgY3JlYXRlZCwgcmVtb3ZlIGJpZ2lxIHRtcCBwYXNzd29yZCBmaWxlCiAgICAgICAgICAgIHRtcF9maWxlPScvbW50L2Nsb3VkVG1wLy5iaWdpcV9wYXNzJwogICAgICAgICAgICB0bXBfZGlyPSQoZGlybmFtZSAkdG1wX2ZpbGUpCiAgICAgICAgICAgIHdpcGVfdGVtcF9kaXIgJHRtcF9kaXIKICAgICAgICAgICAgZWNobyAnRGVsZXRpbmcgYmlnaXEgdGVtcG9yYXJ5IHBhc3N3b3JkIGZpbGUuJwogICAgICAgICAgICAjIFVzZSBiaWdpcSBwYXNzd29yZCBmb3IgZmFpbG92ZXIgc2NyaXB0CiAgICAgICAgICAgIGZhaWxvdmVyX2FyZ3MrPSItLXBhc3N3b3JkLWRhdGEgJGJpZ2lxX3Bhc3N3b3JkICIKICAgICAgICBmaQogICAgICAgIGlmIFsgLW4gIiRhc3NvY2lhdGVfaW50ZiIgXSA7IHRoZW4KICAgICAgICBmYWlsb3Zlcl9hcmdzKz0iLS1hc3NvY2lhdGUtaW50ZiAkYXNzb2NpYXRlX2ludGYgIgogICAgICAgIGZpCgogICAgICAgIGlmIFsgLW4gIiRkaXNzb2NpYXRlX2ludGYiIF0gOyB0aGVuCiAgICAgICAgICAgIGZhaWxvdmVyX2FyZ3MrPSItLWRpc3NvY2lhdGUtaW50ZiAkZGlzc29jaWF0ZV9pbnRmICIKICAgICAgICBmaQogICAgZmkKCiAgICAjIyBNYWtlIHN1cmUgdGhlIHNlY29uZGFyeSBwcml2YXRlIElQIGFkZHJlc3MgaXMgYSBTZWxmIElQCiAgICB0bXNoIGxpc3QgbmV0IHNlbGYgfCBncmVwICIkcHJpdmF0ZV9pcCIKICAgIGlmIFtbICQ/ICE9IDAgXV07IHRoZW4KICAgICAgICB0bXNoIGNyZWF0ZSBuZXQgc2VsZiBsaWNfbWFuYWdlciB2bGFuIGludGVybmFsIGFsbG93LXNlcnZpY2UgZGVmYXVsdCBhZGRyZXNzICR7cHJpdmF0ZV9pcH0vMzIKICAgIGVsc2UKICAgICAgICBlY2hvICJBcHBlYXJzICRwcml2YXRlX2lwIGlzIGFscmVhZHkgYSBTZWxmIElQIgogICAgZmkKCiAgICAjIyBDcmVhdGUgaUNhbGwgc2NyaXB0IGFuZCBoYW5kbGVyIHRvIGhhbmRsZSBmYWlsb3ZlcgogICAgZmFpbG92ZXJfc2NyaXB0X2xvYz0iL2NvbmZpZy9jbG91ZC8ke2Nsb3VkfS9ub2RlX21vZHVsZXMvQGY1ZGV2Y2VudHJhbC9mNS1jbG91ZC1saWJzLSR7Y2xvdWR9L3NjcmlwdHMvZmFpbG92ZXIuanMiCiAgICBpY2FsbF9oYW5kbGVyX25hbWU9IkZhaWxvdmVySGFuZGxlciIKICAgIGljYWxsX3NjcmlwdF9uYW1lPSJGYWlsb3ZlckNvbGxlY3RvciIKICAgICMjIEZpcnN0IGNoZWNrIGlmIGlDYWxsIGFscmVhZHkgZXhpc3RzCiAgICB0bXNoIGxpc3Qgc3lzIGljYWxsIGhhbmRsZXIgfCBncmVwICRpY2FsbF9oYW5kbGVyX25hbWUKICAgIGlmIFtbICQ/ICE9IDAgXV07IHRoZW4KICAgICAgICB0bXNoIGNyZWF0ZSBzeXMgaWNhbGwgc2NyaXB0ICRpY2FsbF9zY3JpcHRfbmFtZSBkZWZpbml0aW9uIHsgaWYgeyBbY2F0Y2gge3NldCBpc19mYWlsb3Zlcl9ydW5uaW5nIFtleGVjIHBncmVwIC1mICAiJGZhaWxvdmVyX3NjcmlwdF9sb2MiXX1dIH0geyBleGVjIG5vZGUgJGZhaWxvdmVyX3NjcmlwdF9sb2MgJGZhaWxvdmVyX2FyZ3MgfSBlbHNlIHsgcHV0cyAiJGljYWxsX3NjcmlwdF9uYW1lIGlzIGFscmVhZHkgcnVubmluZyB3aXRoIFBJRCAkaXNfZmFpbG92ZXJfcnVubmluZyIgfSB9CiAgICAgICAgdG1zaCBjcmVhdGUgc3lzIGljYWxsIGhhbmRsZXIgcGVyaW9kaWMgL0NvbW1vbi8kaWNhbGxfaGFuZGxlcl9uYW1lIHsgZmlyc3Qtb2NjdXJyZW5jZSBub3cgaW50ZXJ2YWwgNjAgc2NyaXB0IC9Db21tb24vJGljYWxsX3NjcmlwdF9uYW1lIH0KICAgIGVsc2UKICAgICAgICBlY2hvICJBcHBlYXJzIHRoZSAkaWNhbGxfaGFuZGxlcl9uYW1lIGljYWxsIGFscmVhZHkgZXhpc3RzISIKICAgIGZpCmZpCgp0bXNoIHNhdmUgc3lzIGNvbmZpZw=="
{%- endset -%}
{%- set image_name_values -%}
{%- if license_type == "byol" %}
{%- if type == "failover" %}
"allowedValues": [
"LTMTwoBootLocations",
"AllTwoBootLocations"
],
"defaultValue": "AllTwoBootLocations"
{%- else %}
"allowedValues": [
"LTMOneBootLocation",
"LTMTwoBootLocations",
"AllOneBootLocation",
"AllTwoBootLocations"
],
"defaultValue": "AllTwoBootLocations"
{%- endif %}

{%- endif %}
{%- if license_type in ("payg", "bigiq-payg")%}
{%- if type == "standalone" -%}
"allowedValues": [
"Best25Mbps",
"Best200Mbps",
"Best1Gbps",
"Best5Gbps",
"Best10Gbps",
"Better25Mbps",
"Better200Mbps",
"Better1Gbps",
"Better5Gbps",
"Better10Gbps",
"Good25Mbps",
"Good200Mbps",
"Good1Gbps",
"Good5Gbps",
"Good10Gbps",
"AdvancedWaf25Mbps",
"AdvancedWaf200Mbps",
"AdvancedWaf1Gbps",
"PerAppVeLTM25Mbps",
"PerAppVeLTM200Mbps",
"PerAppVeAdvancedWaf25Mbps",
"PerAppVeAdvancedWaf200Mbps"
],
"defaultValue": "Best1Gbps"
{%- elif type == "failover" %}
"allowedValues": [
"Best25Mbps",
"Best200Mbps",
"Best1Gbps",
"Best5Gbps",
"Best10Gbps",
"Better25Mbps",
"Better200Mbps",
"Better1Gbps",
"Better5Gbps",
"Better10Gbps",
"Good25Mbps",
"Good200Mbps",
"Good1Gbps",
"Good5Gbps",
"Good10Gbps",
"AdvancedWaf25Mbps",
"AdvancedWaf200Mbps",
"AdvancedWaf1Gbps"
],
"defaultValue": "Best1Gbps"

{%- elif solution == "ltm" %}
"allowedValues": [
"Best25Mbps",
"Best200Mbps",
"Best1Gbps",
"Best5Gbps",
"Best10Gbps",
"Better25Mbps",
"Better200Mbps",
"Better1Gbps",
"Better5Gbps",
"Better10Gbps",
"Good25Mbps",
"Good200Mbps",
"Good1Gbps",
"Good5Gbps",
"Good10Gbps",
"PerAppVeLTM25Mbps",
"PerAppVeLTM200Mbps"
],
"defaultValue": "Best1Gbps"

{%- elif solution == "waf" %}
"allowedValues": [
"Best25Mbps",
"Best200Mbps",
"Best1Gbps",
"Best5Gbps",
"Best10Gbps",
"AdvancedWaf25Mbps",
"AdvancedWaf200Mbps",
"AdvancedWaf1Gbps",
"PerAppVeAdvancedWaf25Mbps",
"PerAppVeAdvancedWaf200Mbps"
],
"defaultValue": "Best1Gbps"
{%- endif %}
{%- endif %}
{%- if license_type in ("bigiq") %}
{%- if type == "failover" %}
"allowedValues": [
"LTMTwoBootLocations",
"AllTwoBootLocations"
],
"defaultValue": "AllTwoBootLocations"
{%- elif type == "autoscale" and solution == "waf" %}
"allowedValues": [
"AllOneBootLocation",
"AllTwoBootLocations"
],
"defaultValue": "AllTwoBootLocations"
{%- else %}
"allowedValues": [
"LTMOneBootLocation",
"LTMTwoBootLocations",
"AllOneBootLocation",
"AllTwoBootLocations"
],
"defaultValue": "AllTwoBootLocations"
{% endif %}

{%- endif %}
{%- endset %}
{%- set static_image_name -%}
{%- if solution == "ltm" %}
"allowedValues": [
"LTMOneBootLocation",
"LTMTwoBootLocations",
"AllOneBootLocation",
"AllTwoBootLocations"
],
"defaultValue": "AllTwoBootLocations"
{% else %}
"allowedValues": [
"AllOneBootLocation",
"AllTwoBootLocations"
],
"defaultValue": "AllTwoBootLocations"
{% endif %}
{%- endset %}

{% set byol_image_name_array -%}
"15": {
"AllOneBootLocation": "big-all-1slot",
"AllTwoBootLocations": "big-all-2slot",
"LTMOneBootLocation": "big-ltm-1slot",
"LTMTwoBootLocations": "big-ltm-2slot"
},
"14": {
"AllOneBootLocation": "big-all-1slot",
"AllTwoBootLocations": "big-all-2slot",
"LTMOneBootLocation": "big-ltm-1slot",
"LTMTwoBootLocations": "big-ltm-2slot"
},
"13": {
"AllOneBootLocation": "big-all-1slot",
"AllTwoBootLocations": "big-all-2slot",
"LTMOneBootLocation": "big-ltm-1slot",
"LTMTwoBootLocations": "big-ltm-2slot"
},
"12": {
"AllOneBootLocation": "big-all-2slot",
"AllTwoBootLocations": "big-all-2slot",
"LTMOneBootLocation": "big-ltm-2slot",
"LTMTwoBootLocations": "big-ltm-2slot"
},
"latest": {
"AllOneBootLocation": "big-all-2slot",
"AllTwoBootLocations": "big-all-2slot",
"LTMOneBootLocation": "big-ltm-2slot",
"LTMTwoBootLocations": "big-ltm-2slot"
},
"offerPostfix": {
"big-all-1slot": "byol",
"big-all-2slot": "byol",
"big-ltm-1slot": "byol",
"big-ltm-2slot": "byol",
"bigip-virtual-edition-best": "best",
"bigip-virtual-edition-good": "good"
}
{%- endset %}
{% set payg_image_map -%}
"advancedwaf1gbps": {
"offer": "f5-big-ip-advanced-waf",
"sku": "f5-bigip-virtual-edition-1g-waf-hourly"
},
"advancedwaf200mbps": {
"offer": "f5-big-ip-advanced-waf",
"sku": "f5-bigip-virtual-edition-200m-waf-hourly"
},
"advancedwaf25mbps": {
"offer": "f5-big-ip-advanced-waf",
"sku": "f5-bigip-virtual-edition-25m-waf-hourly"
},
"best1gbps": {
"offer": "f5-big-ip-best",
"sku": "f5-bigip-virtual-edition-1g-best-hourly"
},
"best5gbps": {
"offer": "f5-big-ip-best",
"sku": "f5-bigip-virtual-edition-5g-best-hourly"
},
"best10gbps": {
"offer": "f5-big-ip-best",
"sku": "f5-bigip-virtual-edition-10g-best-hourly"
},
"best200mbps": {
"offer": "f5-big-ip-best",
"sku": "f5-bigip-virtual-edition-200m-best-hourly"
},
"best25mbps": {
"offer": "f5-big-ip-best",
"sku": "f5-bigip-virtual-edition-25m-best-hourly"
},
"better1gbps": {
"offer": "f5-big-ip-better",
"sku": "f5-bigip-virtual-edition-1g-better-hourly"
},
"better5gbps": {
"offer": "f5-big-ip-better",
"sku": "f5-bigip-virtual-edition-5g-better-hourly"
},
"better10gbps": {
"offer": "f5-big-ip-better",
"sku": "f5-bigip-virtual-edition-10g-better-hourly"
},
"better200mbps": {
"offer": "f5-big-ip-better",
"sku": "f5-bigip-virtual-edition-200m-better-hourly"
},
"better25mbps": {
"offer": "f5-big-ip-better",
"sku": "f5-bigip-virtual-edition-25m-better-hourly"
},
"good1gbps": {
"offer": "f5-big-ip-good",
"sku": "f5-bigip-virtual-edition-1g-good-hourly"
},
"good5gbps": {
"offer": "f5-big-ip-good",
"sku": "f5-bigip-virtual-edition-5g-good-hourly"
},
"good10gbps": {
"offer": "f5-big-ip-good",
"sku": "f5-bigip-virtual-edition-10g-good-hourly"
},
"good200mbps": {
"offer": "f5-big-ip-good",
"sku": "f5-bigip-virtual-edition-200m-good-hourly"
},
"good25mbps": {
"offer": "f5-big-ip-good",
"sku": "f5-bigip-virtual-edition-25m-good-hourly"
},
"perappveadvancedwaf200mbps": {
"offer": "f5-big-ip-per-app-ve",
"sku": "f5-big-ip-per-app-ve-awf-200m-hourly"
},
"perappveadvancedwaf25mbps": {
"offer": "f5-big-ip-per-app-ve",
"sku": "f5-big-ip-per-app-ve-awf-25m-hourly"
},
"perappveltm200mbps": {
"offer": "f5-big-ip-per-app-ve",
"sku": "f5-big-ip-per-app-ve-ltm-200m-hourly"
},
"perappveltm25mbps": {
"offer": "f5-big-ip-per-app-ve",
"sku": "f5-big-ip-per-app-ve-ltm-25m-hourly"
}
{%- endset %}
{% set version_port_map -%}
"15.1.201000": {
"Port": 8443
},
"14.1.003000": {
"Port": 8443
},
"443": {
"Port": 443
},
"latest": {
"Port": 8443
}
{%- endset %}
{% set premium_instance_type_list -%}
"Standard_DS2",
"Standard_DS3",
"Standard_DS4",
"Standard_DS11",
"Standard_DS12",
"Standard_DS13",
"Standard_DS14",
"Standard_DS2_v2",
"Standard_DS3_v2",
"Standard_DS4_v2",
"Standard_DS5_v2",
"Standard_DS11_v2",
"Standard_DS12_v2",
"Standard_DS13_v2",
"Standard_DS14_v2",
"Standard_DS15_v2",
"Standard_F2S",
"Standard_F4S",
"Standard_F8S",
"Standard_F16S",
"Standard_GS2",
"Standard_GS3",
"Standard_GS4",
"Standard_GS5"
{%- endset %}

{# The following cloud library versions are populated on the fly by the main.py script #}
{% set f5_cloud_libs_tag = f5_cloud_libs_latest_tag -%}

{% set f5_cloud_libs_azure_tag = f5_cloud_libs_azure_latest_tag -%}

{% set f5_cloud_workers_tag = f5_cloud_workers_latest_tag -%}

{% set f5_as3_build = f5_as3_latest_build -%}

{% set f5_as3_tag = f5_as3_latest_tag -%}

{% set content_version = latest_content_version %}

{% set f5_networks_tag = f5_networks_latest_tag %}

{% set sku_to_use -%}
{% if license_type in ('byol', 'bigiq') and type != 'bigiq' -%}
concat('f5-', variables('imageNameSub'),'-byol')
{%- elif type == 'bigiq' -%}
"f5-bigiq-virtual-edition-byol"
{%- else -%}
variables('paygImageMap')[variables('imageNameToLower')]['sku']
{%- endif %}
{%- endset %}
{% set offer_to_use -%}
{% if license_type in ('byol', 'bigiq') and type != 'bigiq' -%}
concat('f5-big-ip-', variables('imageNameArray').offerPostfix[variables('imageNameSub')])
{%- elif type == 'bigiq' -%}
"f5-big-iq"
{%- else -%}
variables('paygImageMap')[variables('imageNameToLower')]['offer']
{%- endif %}
{%- endset %}
{% set byol_image_name_sub -%}
{%- if license_type in ('byol', 'bigiq') -%}
"[variables('imageNameArray')[variables('bigIpMajorVersion')][parameters('imageName')]]"
{%- else -%}
"[variables('imageNameArray')[parameters('bigIpVersion')][parameters('staticImageName')]]"
{%- endif -%}
{%- endset %}

{% set min_allowed_values -%}
{% if type == 'autoscale' %}
{% if product in ('ltm', 'waf') and lb_method in ('via-lb', 'dns') %}
{% if license_type == 'bigiq-payg' %}
[0, 1, 2, 3, 4, 5, 6]
{% else %}
[1, 2, 3, 4, 5, 6]
{% endif %}
{% endif %}
{% endif %}
{%- endset %}

{% set max_allowed_values -%}
{% if type == 'autoscale' %}
{% if product in ('ltm', 'waf') and lb_method in ('via-lb', 'dns') %}
{% if license_type == 'bigiq-payg' %}
[1, 2, 3, 4, 5, 6, 7, 8]
{% else %}
[2, 3, 4, 5, 6, 7, 8]
{% endif %}
{% endif %}
{% endif %}
{%- endset %}


{%set number_of_additional_nics%}
{% if type == 'standalone' and nics == 'n' %}
"allowedValues": [
1,
2,
3,
4,
5
],
"defaultValue": 1,
{% endif %}
{% if type == 'failover' and lb_method == 'api' %}
"allowedValues": [
0,
1,
2,
3,
4,
5
],
"defaultValue": 0,
{% endif %}
{% endset %}

{%set additional_nic_location %}
{% if type == 'standalone' and nics == 'n' %}
"additionalNicLocation": {
"metadata": {
"description": "This parameter specifies where the additional NICs go.  This value must be a semi-colon delimited string of subnets, equal to the number of additional NICs being deployed.  For example, for 2 additional NICs you would use: **subnet01;subnet02**. **Note**: Ensure there are no spaces and the correct number of subnets are provided based on the value selected in **numberOfAdditionalNics**. **Important**: The subnet you provide for each additional NIC **must** be unique."
},
"type": "string"
},
{% endif %}
{% if type == 'failover' and lb_method == 'api' %}
"additionalNicLocation": {
"metadata": {
"description": "This parameter specifies where the additional NICs go.  This value must be a semi-colon delimited string of subnets, equal to the number of additional NICs being deployed.  For example, for 2 additional NICs you would use: **subnet01;subnet02**. **Note**: Ensure there are no spaces and the correct number of subnets are provided based on the value selected in **numberOfAdditionalNics**. **Important**: The subnet you provide for each additional NIC **must** be unique."
},
"type": "string"
},
{% endif %}
{% endset %}


{% set waagent_restart_cmd = ", '; if grep -i \"PUT failed\" /var/log/waagent.log -q; then echo \"Killing waagent exthandler, daemon should restart it\"; pkill -f \"python -u /usr/sbin/waagent -run-exthandlers\"; fi'".replace("\"", "\\\"") %}


{% set bigiq_pwd_delete= " rm -f /config/cloud/.bigIqPasswd;" %}

{% set autoscale_file_uris %}
"[concat('https://cdn.f5.com/product/cloudsolutions/f5-cloud-libs/', variables('f5CloudLibsTag'), '/f5-cloud-libs.tar.gz')]",
"[concat('https://cdn.f5.com/product/cloudsolutions/f5-appsvcs-extension/', variables('f5AS3Tag'), '/', variables('f5AS3Build'))]",
"[concat('https://cdn.f5.com/product/cloudsolutions/f5-cloud-libs-azure/', variables('f5CloudLibsAzureTag'), '/f5-cloud-libs-azure.tar.gz')]"
{% if type == 'autoscale'  and solution =='waf' and lb_method in ('via-lb', 'dns') %}
,"[concat(variables('f5NetworksSolutionScripts'), 'asm-policy.tar.gz')]"
{% endif %}
{% endset %}

{%- set hashed_file_list -%}
${config_loc}f5-cloud-libs.tar.gz f5-appsvcs-3.25.0-3.noarch.rpm
{%- if type == "autoscale" and lb_method in ('via-lb', 'dns') and solution == 'ltm' or type == 'failover' and lb_method == 'api' -%}
{{ " " }}${config_loc}f5-cloud-libs-azure.tar.gz
{%- elif  type == "autoscale" and lb_method in ('via-lb', 'dns') and solution == 'waf' -%}
{{ " " }}${config_loc}f5-cloud-libs-azure.tar.gz asm-policy.tar.gz
{%- endif -%}
{%- if lb_method == 'api' -%}
{{ " " }}{{ f5_cfe_latest_build }}
{%- endif -%}
{%- endset -%}
{%- if type == 'autoscale' or type =='failover' and nics == 'n' -%}
{%- set additional_tar_list = "tar xfz /config/cloud/f5-cloud-libs-azure.tar.gz --warning=no-unknown-keyword -C /config/cloud/azure/node_modules/@f5devcentral\n".replace('\n', '\\n') -%}
{%- endif -%}
{%- set install_cloud_libs = "[concat(variables('singleQuote'), '#!/bin/bash\necho about to execute\nchecks=0\nwhile [ $checks -lt 120 ]; do echo checking mcpd\n/usr/bin/tmsh -a show sys mcp-state field-fmt | grep -q running\nif [ $? == 0 ]; then\necho mcpd ready\nbreak\nfi\necho mcpd not ready yet\nlet checks=checks+1\nsleep 1\ndone\necho loading verifyHash script\n/usr/bin/tmsh load sys config merge file /config/verifyHash\nif [ $? != 0 ]; then\necho cannot validate signature of /config/verifyHash\nexit 1\nfi\necho loaded verifyHash\n\nconfig_loc=\"/config/cloud/\"\nhashed_file_list=\"".replace('\n', '\\n').replace('\"', '\\\"')~hashed_file_list~"\"\nfor file in $hashed_file_list; do\necho \"verifying $file\"\n/usr/bin/tmsh run cli script verifyHash $file\nif [ $? != 0 ]; then\necho \"$file is not valid\"\nexit 1\nfi\necho \"verified $file\"\ndone\necho \"expanding $hashed_file_list\"\ntar xfz /config/cloud/f5-cloud-libs.tar.gz --warning=no-unknown-keyword -C /config/cloud/azure/node_modules/@f5devcentral\n".replace('\n', '\\n').replace('\"', '\\\"')~additional_tar_list~"touch /config/cloud/cloudLibsReady', variables('singleQuote'))]".replace('\n', '\\n').replace('\"', '\\\"') %}

{% set big_iq_pwd_cmd = "/usr/bin/install -m 400 /dev/null /config/cloud/.bigIqPasswd; encrypt_secret ', variables('singleQuote'), parameters('bigIqPassword'), variables('singleQuote'), ' \"/config/cloud/.bigIqPasswd\";".replace('\"', '\\\"') %}

{%- set app_script -%}
{%- if type == "autoscale" and solution == 'waf' -%}
"IyEvYmluL2Jhc2gKZnVuY3Rpb24gcGFzc3dkKCkgewogIGVjaG8gfCBmNS1yZXN0LW5vZGUgL2NvbmZpZy9jbG91ZC9henVyZS9ub2RlX21vZHVsZXMvQGY1ZGV2Y2VudHJhbC9mNS1jbG91ZC1saWJzL3NjcmlwdHMvZGVjcnlwdERhdGFGcm9tRmlsZS5qcyAtLWRhdGEtZmlsZSAvY29uZmlnL2Nsb3VkLy5wYXNzd2QgfCBhd2sgJ3twcmludCAkMX0nCn0KCndoaWxlIGdldG9wdHMgbTpkOm46ajprOmg6czp0Omw6YTpjOnI6bzp1OiBvcHRpb24KZG8gY2FzZSAiJG9wdGlvbiIgIGluCiAgICAgICAgbykgZGVjbGFyYXRpb25Vcmw9JE9QVEFSRzs7CiAgICAgICAgbSkgbW9kZT0kT1BUQVJHOzsKICAgICAgICBuKSBwb29sX21lbWJlcj0kT1BUQVJHOzsKICAgICAgICBqKSB2c19odHRwX3BvcnQ9JE9QVEFSRzs7CiAgICAgICAgaykgdnNfaHR0cHNfcG9ydD0kT1BUQVJHOzsKICAgICAgICBoKSBwb29sX2h0dHBfcG9ydD0kT1BUQVJHOzsKICAgICAgICBzKSBwb29sX2h0dHBzX3BvcnQ9JE9QVEFSRzs7CiAgICAgICAgdCkgdHlwZT0kT1BUQVJHOzsKICAgICAgICBsKSBsZXZlbD0kT1BUQVJHOzsKICAgICAgICBhKSBwb2xpY3k9JE9QVEFSRzs7CiAgICAgICAgYykgc3NsX2NlcnQ9JE9QVEFSRzs7CiAgICAgICAgcikgc3NsX3Bhc3N3ZD0kT1BUQVJHOzsKICAgICAgICB1KSB1c2VyPSRPUFRBUkc7OwogICAgZXNhYwpkb25lCgpkZXBsb3llZD0ibm8iCmZpbGVfbG9jPSIvY29uZmlnL2Nsb3VkL2N1c3RvbV9jb25maWciCmRmbF9tZ210X3BvcnQ9YHRtc2ggbGlzdCBzeXMgaHR0cGQgc3NsLXBvcnQgfCBncmVwIHNzbC1wb3J0IHwgc2VkICdzL3NzbC1wb3J0IC8vO3MvIC8vZydgCnVybF9yZWdleD0iKGh0dHA6XC9cL3xodHRwczpcL1wvKT9bYS16MC05XSsoW1wtXC5dezF9W2EtejAtOV0rKSpcLlthLXpdezIsNX0oOlswLTldezEsNX0pPyhcLy4qKT8kIgoKaWYgW1sgJGRlY2xhcmF0aW9uVXJsID1+ICR1cmxfcmVnZXggXV07IHRoZW4KICAgIHJlc3BvbnNlX2NvZGU9JCgvdXNyL2Jpbi9jdXJsIC1zayAtdyAiJXtodHRwX2NvZGV9IiAkZGVjbGFyYXRpb25VcmwgLW8gJGZpbGVfbG9jKQogICAgaWYgW1sgJHJlc3BvbnNlX2NvZGUgPT0gMjAwIF1dOyB0aGVuCiAgICAgICAgIGVjaG8gIkN1c3RvbSBjb25maWcgZG93bmxvYWQgY29tcGxldGU7IGNoZWNraW5nIGZvciB2YWxpZCBKU09OLiIKICAgICAgICAgY2F0ICRmaWxlX2xvYyB8IGpxIC5jbGFzcwogICAgICAgICBpZiBbWyAkPyA9PSAwIF1dOyB0aGVuCiAgICAgICAgICAgICByZXNwb25zZV9jb2RlPSQoL3Vzci9iaW4vY3VybCAtc2t2dnUgJHVzZXI6JChwYXNzd2QpIC13ICIle2h0dHBfY29kZX0iIC1YIFBPU1QgLUggIkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbiIgLUggIkV4cGVjdDoiIGh0dHBzOi8vbG9jYWxob3N0OiRkZmxfbWdtdF9wb3J0L21nbXQvc2hhcmVkL2FwcHN2Y3MvZGVjbGFyZSAtZCBAJGZpbGVfbG9jIC1vIC9kZXYvbnVsbCkKCiAgICAgICAgICAgICBpZiBbWyAkcmVzcG9uc2VfY29kZSA9PSAyMDAgfHwgJHJlc3BvbnNlX2NvZGUgPT0gNTAyIF1dOyB0aGVuCiAgICAgICAgICAgICAgICAgIGVjaG8gIkRlcGxveW1lbnQgb2YgYXBwbGljYXRpb24gc3VjY2VlZGVkLiIKICAgICAgICAgICAgICAgICAgZGVwbG95ZWQ9InllcyIKICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICBlY2hvICJGYWlsZWQgdG8gZGVwbG95IGFwcGxpY2F0aW9uOyBjb250aW51aW5nIHdpdGggcmVzcG9uc2UgY29kZSAnIiRyZXNwb25zZV9jb2RlIiciCiAgICAgICAgICAgICBmaQogICAgICAgICBlbHNlCiAgICAgICAgICAgICBlY2hvICJDdXN0b20gY29uZmlnIHdhcyBub3QgdmFsaWQgSlNPTiwgY29udGludWluZyIKICAgICAgICAgZmkKICAgIGVsc2UKICAgICAgICBlY2hvICJGYWlsZWQgdG8gZG93bmxvYWQgY3VzdG9tIGNvbmZpZzsgY29udGludWluZyB3aXRoIHJlc3BvbnNlIGNvZGUgJyIkcmVzcG9uc2VfY29kZSInIgogICAgZmkKZWxzZQogICAgIGVjaG8gIkN1c3RvbSBjb25maWcgd2FzIG5vdCBhIFVSTCwgY29udGludWluZy4iCmZpCgppZiBbWyAkZGVwbG95ZWQgPT0gIm5vIiAmJiAkZGVjbGFyYXRpb25VcmwgPT0gIk5PVF9TUEVDSUZJRUQiIF1dOyB0aGVuCiAgICBpcF9yZWdleD0nXlswLTldezEsM31cLlswLTldezEsM31cLlswLTldezEsM31cLlswLTldezEsM30kJwogICAgZGZsX21nbXRfcG9ydD1gdG1zaCBsaXN0IHN5cyBodHRwZCBzc2wtcG9ydCB8IGdyZXAgc3NsLXBvcnQgfCBzZWQgJ3Mvc3NsLXBvcnQgLy87cy8gLy9nJ2AKICAgIG1vZGU9YHNlZCAicy8tL18vZyIgPDw8IiRtb2RlImAKICAgIHBheWxvYWQ9J3siY2xhc3MiOiJBREMiLCJzY2hlbWFWZXJzaW9uIjoiMy4wLjAiLCJsYWJlbCI6ImF1dG9zY2FsZV93YWYiLCJpZCI6IkFVVE9TQ0FMRV9XQUYiLCJyZW1hcmsiOiJBdXRvc2NhbGUgV0FGIiwid2FmIjp7ImNsYXNzIjoiVGVuYW50IiwiU2hhcmVkIjp7ImNsYXNzIjoiQXBwbGljYXRpb24iLCJ0ZW1wbGF0ZSI6InNoYXJlZCIsInNlcnZpY2VBZGRyZXNzIjp7ImNsYXNzIjoiU2VydmljZV9BZGRyZXNzIiwidmlydHVhbEFkZHJlc3MiOiIwLjAuMC4wIn0sInBvbGljeVdBRiI6eyJjbGFzcyI6IldBRl9Qb2xpY3kiLCJmaWxlIjoiL3RtcC9hczMwLWxpbnV4LW1lZGl1bS54bWwifX0sImh0dHAiOnsiY2xhc3MiOiJBcHBsaWNhdGlvbiIsInRlbXBsYXRlIjoiaHR0cCIsInBvb2wiOnsiY2xhc3MiOiJQb29sIiwibW9uaXRvcnMiOlsiaHR0cCJdLCJtZW1iZXJzIjpbeyJhZGRyZXNzRGlzY292ZXJ5IjoiZnFkbiIsImF1dG9Qb3B1bGF0ZSI6dHJ1ZSwic2VydmljZVBvcnQiOjgwLCJob3N0bmFtZSI6Ind3dy5leGFtcGxlLmNvbSIsInNlcnZlckFkZHJlc3NlcyI6WyIyNTUuMjU1LjI1NS4yNTQiXX1dfSwic2VydmljZU1haW4iOnsiY2xhc3MiOiJTZXJ2aWNlX0hUVFAiLCJ2aXJ0dWFsQWRkcmVzc2VzIjpbeyJ1c2UiOiIvd2FmL1NoYXJlZC9zZXJ2aWNlQWRkcmVzcyJ9XSwidmlydHVhbFBvcnQiOjgwLCJzbmF0IjoiYXV0byIsInNlY3VyaXR5TG9nUHJvZmlsZXMiOlt7ImJpZ2lwIjoiL0NvbW1vbi9Mb2cgaWxsZWdhbCByZXF1ZXN0cyJ9XSwicG9vbCI6InBvb2wiLCJwb2xpY3lXQUYiOnsidXNlIjoiL3dhZi9TaGFyZWQvcG9saWN5V0FGIn19fSwiaHR0cHMiOnsiY2xhc3MiOiJBcHBsaWNhdGlvbiIsInRlbXBsYXRlIjoiaHR0cHMiLCJzZXJ2ZXJUTFMiOnsiY2xhc3MiOiJUTFNfU2VydmVyIiwiY2VydGlmaWNhdGVzIjpbeyJjZXJ0aWZpY2F0ZSI6ImNlcnRTZXJ2ZXIifV0sImF1dGhlbnRpY2F0aW9uVHJ1c3RDQSI6eyJiaWdpcCI6Ii9Db21tb24vY2EtYnVuZGxlLmNydCJ9fSwiY2VydFNlcnZlciI6eyJjbGFzcyI6IkNlcnRpZmljYXRlIiwiY2VydGlmaWNhdGUiOnsiYmlnaXAiOiIvQ29tbW9uL3dhZkNlcnQuY3J0In0sInByaXZhdGVLZXkiOnsiYmlnaXAiOiIvQ29tbW9uL3dhZkNlcnQua2V5In19LCJjbGllbnRUTFMiOnsiY2xhc3MiOiJUTFNfQ2xpZW50In0sInBvb2wiOnsiY2xhc3MiOiJQb29sIiwibW9uaXRvcnMiOlsiaHR0cHMiXSwibWVtYmVycyI6W3siYWRkcmVzc0Rpc2NvdmVyeSI6ImZxZG4iLCJhdXRvUG9wdWxhdGUiOnRydWUsInNlcnZpY2VQb3J0Ijo0NDMsImhvc3RuYW1lIjoid3d3LmV4YW1wbGUuY29tIiwic2VydmVyQWRkcmVzc2VzIjpbIjI1NS4yNTUuMjU1LjI1NCJdfV19LCJzZXJ2aWNlTWFpbiI6eyJjbGFzcyI6IlNlcnZpY2VfSFRUUFMiLCJ2aXJ0dWFsQWRkcmVzc2VzIjpbeyJ1c2UiOiIvd2FmL1NoYXJlZC9zZXJ2aWNlQWRkcmVzcyJ9XSwidmlydHVhbFBvcnQiOjQ0Mywic2VydmVyVExTIjoic2VydmVyVExTIiwiY2xpZW50VExTIjoiY2xpZW50VExTIiwicmVkaXJlY3Q4MCI6dHJ1ZSwic25hdCI6ImF1dG8iLCJzZWN1cml0eUxvZ1Byb2ZpbGVzIjpbeyJiaWdpcCI6Ii9Db21tb24vTG9nIGlsbGVnYWwgcmVxdWVzdHMifV0sInBvb2wiOiJwb29sIiwicG9saWN5V0FGIjp7InVzZSI6Ii93YWYvU2hhcmVkL3BvbGljeVdBRiJ9fX0sImh0dHBzX29mZmxvYWQiOnsiY2xhc3MiOiJBcHBsaWNhdGlvbiIsInRlbXBsYXRlIjoiaHR0cHMiLCJzZXJ2ZXJUTFMiOnsiY2xhc3MiOiJUTFNfU2VydmVyIiwiY2VydGlmaWNhdGVzIjpbeyJjZXJ0aWZpY2F0ZSI6ImNlcnRTZXJ2ZXIifV0sImF1dGhlbnRpY2F0aW9uVHJ1c3RDQSI6eyJiaWdpcCI6Ii9Db21tb24vY2EtYnVuZGxlLmNydCJ9fSwiY2VydFNlcnZlciI6eyJjbGFzcyI6IkNlcnRpZmljYXRlIiwiY2VydGlmaWNhdGUiOnsiYmlnaXAiOiIvQ29tbW9uL3dhZkNlcnQuY3J0In0sInByaXZhdGVLZXkiOnsiYmlnaXAiOiIvQ29tbW9uL3dhZkNlcnQua2V5In19LCJwb29sIjp7ImNsYXNzIjoiUG9vbCIsIm1vbml0b3JzIjpbImh0dHAiXSwibWVtYmVycyI6W3siYWRkcmVzc0Rpc2NvdmVyeSI6ImZxZG4iLCJhdXRvUG9wdWxhdGUiOnRydWUsInNlcnZpY2VQb3J0Ijo4MCwiaG9zdG5hbWUiOiJ3d3cuZXhhbXBsZS5jb20iLCJzZXJ2ZXJBZGRyZXNzZXMiOlsiMjU1LjI1NS4yNTUuMjU0Il19XX0sInNlcnZpY2VNYWluIjp7ImNsYXNzIjoiU2VydmljZV9IVFRQUyIsInZpcnR1YWxBZGRyZXNzZXMiOlt7InVzZSI6Ii93YWYvU2hhcmVkL3NlcnZpY2VBZGRyZXNzIn1dLCJ2aXJ0dWFsUG9ydCI6ODAsInNlcnZlclRMUyI6InNlcnZlclRMUyIsInNuYXQiOiJhdXRvIiwic2VjdXJpdHlMb2dQcm9maWxlcyI6W3siYmlnaXAiOiIvQ29tbW9uL0xvZyBpbGxlZ2FsIHJlcXVlc3RzIn1dLCJwb29sIjoicG9vbCIsInBvbGljeVdBRiI6eyJ1c2UiOiIvd2FmL1NoYXJlZC9wb2xpY3lXQUYifX19fX0nCgogICAgIyB2ZXJpZnkgdGhhdCB0aGUgY3VzdG9tIHBvbGljeSBpcyBhIFVSTAogICAgaWYgW1sgJGxldmVsID09ICJjdXN0b20iIF1dOyB0aGVuCiAgICAgICAgIGlmIFtbIC1uICRwb2xpY3kgJiYgJHBvbGljeSAhPSAiTk9UX1NQRUNJRklFRCIgXV07IHRoZW4KICAgICAgICAgICAgIGlmIFtbICRwb2xpY3kgPX4gJHVybF9yZWdleCBdXTsgdGhlbgogICAgICAgICAgICAgICAgICBjdXN0b21fcG9saWN5PSRwb2xpY3kKICAgICAgICAgICAgICAgICAgL3Vzci9iaW4vY3VybCAtc2sgJGN1c3RvbV9wb2xpY3kgLS1yZXRyeSAzIC1vIC90bXAvY3VzdG9tX3BvbGljeS54bWwKICAgICAgICAgICAgICAgICAgYXNtX3BvbGljeT0iL3RtcC9jdXN0b21fcG9saWN5LnhtbCIKICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgZWNobyAiQ3VzdG9tIHBvbGljeSB3YXMgbm90IGEgVVJMLCBkZWZhdWx0aW5nIHRvIGhpZ2giCiAgICAgICAgICAgICAgICAgIGFzbV9wb2xpY3k9Ii9jb25maWcvY2xvdWQvYXNtLXBvbGljeS0kdHlwZS1oaWdoLnhtbCIKICAgICAgICAgICAgIGZpCiAgICAgICAgIGVsc2UKICAgICAgICAgICAgICBlY2hvICJDdXN0b20gcG9saWN5IHdhcyBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0aW5nIHRvIGhpZ2giCiAgICAgICAgICAgICAgYXNtX3BvbGljeT0iL2NvbmZpZy9jbG91ZC9hc20tcG9saWN5LSR0eXBlLWhpZ2gueG1sIgogICAgICAgICBmaQogICAgZWxzZQogICAgICAgICBhc21fcG9saWN5PSIvY29uZmlnL2Nsb3VkL2FzbS1wb2xpY3ktJHR5cGUtJGxldmVsLnhtbCIKICAgIGZpCgogICAgaWYgW1sgJG1vZGUgPT0gImh0dHBzIiB8fCAkbW9kZSA9PSAiaHR0cF9odHRwcyIgfHwgJG1vZGUgPT0gImh0dHBzX29mZmxvYWQiIF1dOyB0aGVuCiAgICAgICAgIGNoYWluPSIvQ29tbW9uL2NhLWJ1bmRsZS5jcnQiCgogICAgICAgICBlY2hvICJTdGFydGluZyBDZXJ0aWZpY2F0ZSBkb3dubG9hZCIKCiAgICAgICAgIGNlcnRpZmljYXRlX2xvY2F0aW9uPSRzc2xfY2VydAoKICAgICAgICAgcmVzcG9uc2VfY29kZT0kKC91c3IvYmluL2N1cmwgLXNrIC11ICR1c2VyOiQocGFzc3dkKSAtdyAiJXtodHRwX2NvZGV9IiAgLVggUE9TVCAtSCAiQ29udGVudC10eXBlOiBhcHBsaWNhdGlvbi9qc29uIiBodHRwczovL2xvY2FsaG9zdDokZGZsX21nbXRfcG9ydC9tZ210L3RtL3V0aWwvYmFzaCAtZCAneyAiY29tbWFuZCI6InJ1biIsInV0aWxDbWRBcmdzIjoiLWMgXCJjdXJsIC1rIC1zIC1mIC0tcmV0cnkgNSAtLXJldHJ5LWRlbGF5IDEwIC0tcmV0cnktbWF4LXRpbWUgMTAgLW8gL2NvbmZpZy90bXAucGZ4ICckY2VydGlmaWNhdGVfbG9jYXRpb24nXCIiIH0nIC1vIC9kZXYvbnVsbCkKCiAgICAgICAgIGlmIFtbICRyZXNwb25zZV9jb2RlID09IDIwMCAgXV07IHRoZW4KICAgICAgICAgICAgICBlY2hvICJDZXJ0aWZpY2F0ZSBkb3dubG9hZCBjb21wbGV0ZS4iCiAgICAgICAgIGVsc2UKICAgICAgICAgICAgIGVjaG8gIkZhaWxlZCB0byBkb3dubG9hZCBTU0wgY2VydDsgZXhpdGluZyB3aXRoIHJlc3BvbnNlIGNvZGUgJyIkcmVzcG9uc2VfY29kZSInIgogICAgICAgICAgICAgZXhpdCAxCiAgICAgICAgIGZpCgogICAgICAgICByZXNwb25zZV9jb2RlPSQoL3Vzci9iaW4vY3VybCAtc2t1ICR1c2VyOiQocGFzc3dkKSAtdyAiJXtodHRwX2NvZGV9IiAtWCBQT1NUIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIGh0dHBzOi8vbG9jYWxob3N0OiRkZmxfbWdtdF9wb3J0L21nbXQvdG0vc3lzL2NyeXB0by9wa2NzMTIgLWQgJ3siY29tbWFuZCI6ICJpbnN0YWxsIiwibmFtZSI6ICJ3YWZDZXJ0Iiwib3B0aW9ucyI6IFsgeyAiZnJvbS1sb2NhbC1maWxlIjogIi9jb25maWcvdG1wLnBmeCIgfSwgeyAicGFzc3BocmFzZSI6ICInIiRzc2xfcGFzc3dkIiciIH0gXSB9JyAtbyAvZGV2L251bGwpCgogICAgICAgICBpZiBbWyAkcmVzcG9uc2VfY29kZSA9PSAyMDAgIF1dOyB0aGVuCiAgICAgICAgICAgICAgZWNobyAiQ2VydGlmaWNhdGUgaW5zdGFsbCBjb21wbGV0ZS4iCiAgICAgICAgIGVsc2UKICAgICAgICAgICAgIGVjaG8gIkZhaWxlZCB0byBpbnN0YWxsIFNTTCBjZXJ0OyBleGl0aW5nIHdpdGggcmVzcG9uc2UgY29kZSAnIiRyZXNwb25zZV9jb2RlIiciCiAgICAgICAgICAgICBleGl0IDEKICAgICAgICAgZmkKICAgIGZpCgogICAgcGF5bG9hZD0kKGVjaG8gJHBheWxvYWQgfCBqcSAtYyAtLWFyZyBhc21fcG9saWN5ICRhc21fcG9saWN5ICcgLndhZi5TaGFyZWQucG9saWN5V0FGLmZpbGUgPSAkYXNtX3BvbGljeScpCgogICAgcGF5bG9hZD0kKGVjaG8gJHBheWxvYWQgfCBqcSAtYyAtLWFyZyBwb29sX2h0dHBfcG9ydCAkcG9vbF9odHRwX3BvcnQgLS1hcmcgcG9vbF9odHRwc19wb3J0ICRwb29sX2h0dHBzX3BvcnQgLS1hcmcgdnNfaHR0cF9wb3J0ICR2c19odHRwX3BvcnQgLS1hcmcgdnNfaHR0cHNfcG9ydCAkdnNfaHR0cHNfcG9ydCAnIC53YWYuaHR0cC5wb29sLm1lbWJlcnNbMF0uc2VydmljZVBvcnQgPSAoJHBvb2xfaHR0cF9wb3J0IHwgdG9udW1iZXIpIHwgLndhZi5odHRwLnNlcnZpY2VNYWluLnZpcnR1YWxQb3J0ID0gKCR2c19odHRwX3BvcnQgfCB0b251bWJlcikgfCAud2FmLmh0dHBzLnBvb2wubWVtYmVyc1swXS5zZXJ2aWNlUG9ydCA9ICgkcG9vbF9odHRwc19wb3J0IHwgdG9udW1iZXIpIHwgLndhZi5odHRwcy5zZXJ2aWNlTWFpbi52aXJ0dWFsUG9ydCA9ICgkdnNfaHR0cHNfcG9ydCB8IHRvbnVtYmVyKSB8IC53YWYuaHR0cHNfb2ZmbG9hZC5wb29sLm1lbWJlcnNbMF0uc2VydmljZVBvcnQgPSAoJHBvb2xfaHR0cF9wb3J0IHwgdG9udW1iZXIpIHwgLndhZi5odHRwc19vZmZsb2FkLnNlcnZpY2VNYWluLnZpcnR1YWxQb3J0ID0gKCR2c19odHRwc19wb3J0IHwgdG9udW1iZXIpJykKCiAgICBpZiBbWyAkcG9vbF9tZW1iZXIgPX4gJGlwX3JlZ2V4IF1dOyB0aGVuCiAgICAgICAgIHBheWxvYWQ9JChlY2hvICRwYXlsb2FkIHwganEgLWMgJ2RlbCgud2FmLmh0dHAucG9vbC5tZW1iZXJzWzBdLmF1dG9Qb3B1bGF0ZSkgfCBkZWwoLndhZi5odHRwLnBvb2wubWVtYmVyc1swXS5ob3N0bmFtZSkgfCBkZWwoLndhZi5odHRwLnBvb2wubWVtYmVyc1swXS5hZGRyZXNzRGlzY292ZXJ5KSB8ICBkZWwoLndhZi5odHRwcy5wb29sLm1lbWJlcnNbMF0uYXV0b1BvcHVsYXRlKSB8IGRlbCgud2FmLmh0dHBzLnBvb2wubWVtYmVyc1swXS5ob3N0bmFtZSkgfCBkZWwoLndhZi5odHRwcy5wb29sLm1lbWJlcnNbMF0uYWRkcmVzc0Rpc2NvdmVyeSkgfCBkZWwoLndhZi5odHRwc19vZmZsb2FkLnBvb2wubWVtYmVyc1swXS5hdXRvUG9wdWxhdGUpIHwgZGVsKC53YWYuaHR0cHNfb2ZmbG9hZC5wb29sLm1lbWJlcnNbMF0uaG9zdG5hbWUpIHwgZGVsKC53YWYuaHR0cHNfb2ZmbG9hZC5wb29sLm1lbWJlcnNbMF0uYWRkcmVzc0Rpc2NvdmVyeSknKQoKICAgICAgICAgcGF5bG9hZD0kKGVjaG8gJHBheWxvYWQgfCBqcSAtYyAtLWFyZyBwb29sX21lbWJlciAkcG9vbF9tZW1iZXIgJy53YWYuaHR0cC5wb29sLm1lbWJlcnNbMF0uc2VydmVyQWRkcmVzc2VzWzBdID0gJHBvb2xfbWVtYmVyIHwgLndhZi5odHRwcy5wb29sLm1lbWJlcnNbMF0uc2VydmVyQWRkcmVzc2VzWzBdID0gJHBvb2xfbWVtYmVyIHwgLndhZi5odHRwc19vZmZsb2FkLnBvb2wubWVtYmVyc1swXS5zZXJ2ZXJBZGRyZXNzZXNbMF0gPSAkcG9vbF9tZW1iZXInKQogICAgZWxzZQogICAgICAgICBwYXlsb2FkPSQoZWNobyAkcGF5bG9hZCB8IGpxIC1jICdkZWwoLndhZi5odHRwLnBvb2wubWVtYmVyc1swXS5zZXJ2ZXJBZGRyZXNzZXMpIHwgZGVsKC53YWYuaHR0cHMucG9vbC5tZW1iZXJzWzBdLnNlcnZlckFkZHJlc3NlcykgfCBkZWwoLndhZi5odHRwc19vZmZsb2FkLnBvb2wubWVtYmVyc1swXS5zZXJ2ZXJBZGRyZXNzZXMpJykKCiAgICAgICAgIHBheWxvYWQ9JChlY2hvICRwYXlsb2FkIHwganEgLWMgLS1hcmcgcG9vbF9tZW1iZXIgJHBvb2xfbWVtYmVyICcud2FmLmh0dHAucG9vbC5tZW1iZXJzWzBdLmhvc3RuYW1lID0gJHBvb2xfbWVtYmVyIHwgLndhZi5odHRwcy5wb29sLm1lbWJlcnNbMF0uaG9zdG5hbWUgPSAkcG9vbF9tZW1iZXIgfCAud2FmLmh0dHBzX29mZmxvYWQucG9vbC5tZW1iZXJzWzBdLmhvc3RuYW1lID0gJHBvb2xfbWVtYmVyJykKICAgIGZpCgogICAgaWYgW1sgJG1vZGUgPT0gImh0dHAiIF1dOyB0aGVuCiAgICAgICAgcGF5bG9hZD0kKGVjaG8gJHBheWxvYWQgfCBqcSAtYyAnZGVsKC53YWYuaHR0cHMpIHwgZGVsKC53YWYuaHR0cHNfb2ZmbG9hZCknKQogICAgZWxpZiBbWyAkbW9kZSA9PSAiaHR0cHMiIF1dOyB0aGVuCiAgICAgICAgcGF5bG9hZD0kKGVjaG8gJHBheWxvYWQgfCBqcSAtYyAnZGVsKC53YWYuaHR0cCkgfCBkZWwoLndhZi5odHRwc19vZmZsb2FkKSB8IC53YWYuaHR0cHMuY2VydFNlcnZlci5jZXJ0aWZpY2F0ZS5iaWdpcCA9ICIvQ29tbW9uL3dhZkNlcnQuY3J0IiB8IC53YWYuaHR0cHMuY2VydFNlcnZlci5wcml2YXRlS2V5LmJpZ2lwID0gIi9Db21tb24vd2FmQ2VydC5rZXkiJykKICAgIGVsaWYgW1sgJG1vZGUgPT0gImh0dHBfaHR0cHMiIF1dOyB0aGVuCiAgICAgICAgcGF5bG9hZD0kKGVjaG8gJHBheWxvYWQgfCBqcSAtYyAnZGVsKC53YWYuaHR0cHNfb2ZmbG9hZCkgfCAud2FmLmh0dHBzLnNlcnZpY2VNYWluLnJlZGlyZWN0ODAgPSBmYWxzZSB8IC53YWYuaHR0cHMuY2VydFNlcnZlci5jZXJ0aWZpY2F0ZS5iaWdpcCA9ICIvQ29tbW9uL3dhZkNlcnQuY3J0IiB8IC53YWYuaHR0cHMuY2VydFNlcnZlci5wcml2YXRlS2V5LmJpZ2lwID0gIi9Db21tb24vd2FmQ2VydC5rZXkiJykKICAgIGVsc2UKICAgICAgICBwYXlsb2FkPSQoZWNobyAkcGF5bG9hZCB8IGpxIC1jICdkZWwoLndhZi5odHRwKSB8IGRlbCgud2FmLmh0dHBzKSB8IC53YWYuaHR0cHNfb2ZmbG9hZC5jZXJ0U2VydmVyLmNlcnRpZmljYXRlLmJpZ2lwID0gIi9Db21tb24vd2FmQ2VydC5jcnQiIHwgLndhZi5odHRwc19vZmZsb2FkLmNlcnRTZXJ2ZXIucHJpdmF0ZUtleS5iaWdpcCA9ICIvQ29tbW9uL3dhZkNlcnQua2V5IicpCiAgICBmaQoKICAgICByZXNwb25zZV9jb2RlPSQoL3Vzci9iaW4vY3VybCAtc2t2dnUgJHVzZXI6JChwYXNzd2QpIC13ICIle2h0dHBfY29kZX0iIC1YIFBPU1QgLUggIkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbiIgLUggIkV4cGVjdDoiIGh0dHBzOi8vbG9jYWxob3N0OiRkZmxfbWdtdF9wb3J0L21nbXQvc2hhcmVkL2FwcHN2Y3MvZGVjbGFyZSAtZCAiJHBheWxvYWQiIC1vIC9kZXYvbnVsbCkKCiAgICAgaWYgW1sgJHJlc3BvbnNlX2NvZGUgPT0gMjAwIHx8ICRyZXNwb25zZV9jb2RlID09IDUwMiAgXV07IHRoZW4KICAgICAgICAgIGVjaG8gIkRlcGxveW1lbnQgb2YgYXBwbGljYXRpb24gc3VjY2VlZGVkLiIKICAgIGVsc2UKICAgICAgICAgZWNobyAiRmFpbGVkIHRvIGRlcGxveSBhcHBsaWNhdGlvbjsgZXhpdGluZyB3aXRoIHJlc3BvbnNlIGNvZGUgJyIkcmVzcG9uc2VfY29kZSInIgogICAgICAgICBleGl0IDEKICAgICBmaQogZmkKCmVjaG8gIkRlcGxveW1lbnQgY29tcGxldGUuIgpleGl0"
{%- elif type =='failover' and lb_method == 'api'  -%}
"IyEvYmluL2Jhc2gKZnVuY3Rpb24gcGFzc3dkKCkgewogIGVjaG8gfCBmNS1yZXN0LW5vZGUgL2NvbmZpZy9jbG91ZC9henVyZS9ub2RlX21vZHVsZXMvQGY1ZGV2Y2VudHJhbC9mNS1jbG91ZC1saWJzL3NjcmlwdHMvZGVjcnlwdERhdGFGcm9tRmlsZS5qcyAtLWRhdGEtZmlsZSAvY29uZmlnL2Nsb3VkLy5wYXNzd2QgfCBhd2sgJ3twcmludCAkMX0nCn0KCndoaWxlIGdldG9wdHMgbzp1OmY6IG9wdGlvbgpkbyBjYXNlICIkb3B0aW9uIiAgaW4KICAgICAgICBvKSBkZWNsYXJhdGlvblVybD0kT1BUQVJHOzsKICAgICAgICB1KSB1c2VyPSRPUFRBUkc7OwogICAgICAgIGYpIGlzQXMzPSRPUFRBUkc7OwogICAgZXNhYwpkb25lCgpkZXBsb3llZD0ibm8iCmZpbGVfbG9jPSIvY29uZmlnL2Nsb3VkL2N1c3RvbV9jb25maWciCmRmbF9tZ210X3BvcnQ9YHRtc2ggbGlzdCBzeXMgaHR0cGQgc3NsLXBvcnQgfCBncmVwIHNzbC1wb3J0IHwgc2VkICdzL3NzbC1wb3J0IC8vO3MvIC8vZydgCnVybF9yZWdleD0iKGh0dHA6XC9cL3xodHRwczpcL1wvKT9bYS16MC05XSsoW1wtXC5dezF9W2EtejAtOV0rKSpcLlthLXpdezIsNX0oOlswLTldezEsNX0pPyhcLy4qKT8kIgoKaWYgW1sgJGRlY2xhcmF0aW9uVXJsID1+ICR1cmxfcmVneCAmJiAkaXNBczMgPX4gImRvX2FzIiBdXTsgdGhlbgogICAgcmVzcG9uc2VfY29kZT0kKC91c3IvYmluL2N1cmwgLXNrIC13ICIle2h0dHBfY29kZX0iICRkZWNsYXJhdGlvblVybCAtbyAkZmlsZV9sb2MpCiAgICBpZiBbWyAkcmVzcG9uc2VfY29kZSA9PSAyMDAgXV07IHRoZW4KICAgICAgICAgZWNobyAiQ3VzdG9tIGNvbmZpZyBkb3dubG9hZCBjb21wbGV0ZTsgY2hlY2tpbmcgZm9yIHZhbGlkIEpTT04uIgogICAgICAgICBjYXQgJGZpbGVfbG9jIHwganEgLmNsYXNzCiAgICAgICAgIGlmIFtbICQ/ID09IDAgXV07IHRoZW4KICAgICAgICAgICAgIHJlc3BvbnNlX2NvZGU9JCgvdXNyL2Jpbi9jdXJsIC1za3Z2dSAkdXNlcjokKHBhc3N3ZCkgLXcgIiV7aHR0cF9jb2RlfSIgLVggUE9TVCAtSCAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uIiAtSCAiRXhwZWN0OiIgaHR0cHM6Ly9sb2NhbGhvc3Q6JGRmbF9tZ210X3BvcnQvbWdtdC9zaGFyZWQvYXBwc3Zjcy9kZWNsYXJlIC1kIEAkZmlsZV9sb2MgLW8gL2Rldi9udWxsKQoKICAgICAgICAgICAgIGlmIFtbICRyZXNwb25zZV9jb2RlID09IDIwMCB8fCAkcmVzcG9uc2VfY29kZSA9PSA1MDIgXV07IHRoZW4KICAgICAgICAgICAgICAgICAgZWNobyAiRGVwbG95bWVudCBvZiBhcHBsaWNhdGlvbiBzdWNjZWVkZWQuIgogICAgICAgICAgICAgICAgICBkZXBsb3llZD0ieWVzIgogICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgIGVjaG8gIkZhaWxlZCB0byBkZXBsb3kgYXBwbGljYXRpb247IGNvbnRpbnVpbmcgd2l0aCByZXNwb25zZSBjb2RlICciJHJlc3BvbnNlX2NvZGUiJyIKICAgICAgICAgICAgIGZpCiAgICAgICAgIGVsc2UKICAgICAgICAgICAgIGVjaG8gIkN1c3RvbSBjb25maWcgd2FzIG5vdCB2YWxpZCBKU09OLCBjb250aW51aW5nIgogICAgICAgICBmaQogICAgZWxzZQogICAgICAgIGVjaG8gIkZhaWxlZCB0byBkb3dubG9hZCBjdXN0b20gY29uZmlnOyBjb250aW51aW5nIHdpdGggcmVzcG9uc2UgY29kZSAnIiRyZXNwb25zZV9jb2RlIiciCiAgICBmaQplbHNlCiAgICAgZWNobyAiQ3VzdG9tIGNvbmZpZyB3YXMgbm90IGEgVVJMLCBjb250aW51aW5nLiIKZmkKCmlmIFtbICRkZXBsb3llZCA9PSAibm8iICYmICRkZWNsYXJhdGlvblVybCA9PSAiTk9UX1NQRUNJRklFRCIgJiYgICQyICE9ICdza2lwX2FzMycgXV07IHRoZW4KICAgIGVjaG8gIkFwcGxpY2F0aW9uIGRlcGxveW1lbnQgZmFpbGVkIG9yIGN1c3RvbSBVUkwgd2FzIG5vdCBzcGVjaWZpZWQuIgpmaQoKY2ZlX2ZpbGVfbG9jPS9jb25maWcvY2xvdWQvYXp1cmUvY2ZlLWluaXQuY2ZnCmNmZV9yZXNwb25zZV9jb2RlPSQoL3Vzci9iaW4vY3VybCAtc2t2dnUgJHVzZXI6JChwYXNzd2QpIC13ICIle2h0dHBfY29kZX0iIC1YIFBPU1QgLUggIkNvbnRlbnQtVHlwZTphcHBsaWNhdGlvbi9qc29uIiBodHRwczovL2xvY2FsaG9zdDo0NDMvbWdtdC9zaGFyZWQvY2xvdWQtZmFpbG92ZXIvZGVjbGFyZSAtZCBAJGNmZV9maWxlX2xvYykKCmlmIFtbICRjZmVfcmVzcG9uc2VfY29kZSA9PSAyMDAgfHwgJGNmZV9yZXNwb25zZV9jb2RlID09IDUwMiBdXTsgdGhlbgogICAgZWNobyAiRGVwbG95bWVudCBvZiBDRkUgYXBwbGljYXRpb24gc3VjY2VlZGVkLiIKZWxzZQogICAgZWNobyAiRmFpbGVkIHRvIGRlcGxveSBDRkUgYXBwbGljYXRpb24gd2l0aCByZXNwb25zZSBjb2RlICciJGNmZV9yZXNwb25zZV9jb2RlIiciCmZpCgplY2hvICJEZXBsb3ltZW50IGNvbXBsZXRlLiIKZXhpdA=="
{%- else -%}
"IyEvYmluL2Jhc2gKZnVuY3Rpb24gcGFzc3dkKCkgewogIGVjaG8gfCBmNS1yZXN0LW5vZGUgL2NvbmZpZy9jbG91ZC9henVyZS9ub2RlX21vZHVsZXMvQGY1ZGV2Y2VudHJhbC9mNS1jbG91ZC1saWJzL3NjcmlwdHMvZGVjcnlwdERhdGFGcm9tRmlsZS5qcyAtLWRhdGEtZmlsZSAvY29uZmlnL2Nsb3VkLy5wYXNzd2QgfCBhd2sgJ3twcmludCAkMX0nCn0KCndoaWxlIGdldG9wdHMgbzp1OiBvcHRpb24KZG8gY2FzZSAiJG9wdGlvbiIgIGluCiAgICAgICAgbykgZGVjbGFyYXRpb25Vcmw9JE9QVEFSRzs7CiAgICAgICAgdSkgdXNlcj0kT1BUQVJHOzsKICAgIGVzYWMKZG9uZQoKZGVwbG95ZWQ9Im5vIgpmaWxlX2xvYz0iL2NvbmZpZy9jbG91ZC9jdXN0b21fY29uZmlnIgpkZmxfbWdtdF9wb3J0PWB0bXNoIGxpc3Qgc3lzIGh0dHBkIHNzbC1wb3J0IHwgZ3JlcCBzc2wtcG9ydCB8IHNlZCAncy9zc2wtcG9ydCAvLztzLyAvL2cnYAp1cmxfcmVnZXg9IihodHRwOlwvXC98aHR0cHM6XC9cLyk/W2EtejAtOV0rKFtcLVwuXXsxfVthLXowLTldKykqXC5bYS16XXsyLDV9KDpbMC05XXsxLDV9KT8oXC8uKik/JCIKCmlmIFtbICRkZWNsYXJhdGlvblVybCA9fiAkdXJsX3JlZ2V4IF1dOyB0aGVuCiAgICByZXNwb25zZV9jb2RlPSQoL3Vzci9iaW4vY3VybCAtc2sgLXcgIiV7aHR0cF9jb2RlfSIgJGRlY2xhcmF0aW9uVXJsIC1vICRmaWxlX2xvYykKICAgIGlmIFtbICRyZXNwb25zZV9jb2RlID09IDIwMCBdXTsgdGhlbgogICAgICAgICBlY2hvICJDdXN0b20gY29uZmlnIGRvd25sb2FkIGNvbXBsZXRlOyBjaGVja2luZyBmb3IgdmFsaWQgSlNPTi4iCiAgICAgICAgIGNhdCAkZmlsZV9sb2MgfCBqcSAuY2xhc3MKICAgICAgICAgaWYgW1sgJD8gPT0gMCBdXTsgdGhlbgogICAgICAgICAgICAgcmVzcG9uc2VfY29kZT0kKC91c3IvYmluL2N1cmwgLXNrdnZ1ICR1c2VyOiQocGFzc3dkKSAtdyAiJXtodHRwX2NvZGV9IiAtWCBQT1NUIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIC1IICJFeHBlY3Q6IiBodHRwczovL2xvY2FsaG9zdDokZGZsX21nbXRfcG9ydC9tZ210L3NoYXJlZC9hcHBzdmNzL2RlY2xhcmUgLWQgQCRmaWxlX2xvYyAtbyAvZGV2L251bGwpCgogICAgICAgICAgICAgaWYgW1sgJHJlc3BvbnNlX2NvZGUgPT0gMjAwIHx8ICRyZXNwb25zZV9jb2RlID09IDUwMiBdXTsgdGhlbgogICAgICAgICAgICAgICAgICBlY2hvICJEZXBsb3ltZW50IG9mIGFwcGxpY2F0aW9uIHN1Y2NlZWRlZC4iCiAgICAgICAgICAgICAgICAgIGRlcGxveWVkPSJ5ZXMiCiAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgZWNobyAiRmFpbGVkIHRvIGRlcGxveSBhcHBsaWNhdGlvbjsgY29udGludWluZyB3aXRoIHJlc3BvbnNlIGNvZGUgJyIkcmVzcG9uc2VfY29kZSInIgogICAgICAgICAgICAgZmkKICAgICAgICAgZWxzZQogICAgICAgICAgICAgZWNobyAiQ3VzdG9tIGNvbmZpZyB3YXMgbm90IHZhbGlkIEpTT04sIGNvbnRpbnVpbmciCiAgICAgICAgIGZpCiAgICBlbHNlCiAgICAgICAgZWNobyAiRmFpbGVkIHRvIGRvd25sb2FkIGN1c3RvbSBjb25maWc7IGNvbnRpbnVpbmcgd2l0aCByZXNwb25zZSBjb2RlICciJHJlc3BvbnNlX2NvZGUiJyIKICAgIGZpCmVsc2UKICAgICBlY2hvICJDdXN0b20gY29uZmlnIHdhcyBub3QgYSBVUkwsIGNvbnRpbnVpbmcuIgpmaQoKaWYgW1sgJGRlcGxveWVkID09ICJubyIgJiYgJGRlY2xhcmF0aW9uVXJsID09ICJOT1RfU1BFQ0lGSUVEIiBdXTsgdGhlbgogICAgZWNobyAiQXBwbGljYXRpb24gZGVwbG95bWVudCBmYWlsZWQgb3IgY3VzdG9tIFVSTCB3YXMgbm90IHNwZWNpZmllZC4iCmZpCgplY2hvICJEZXBsb3ltZW50IGNvbXBsZXRlLiIKZXhpdA=="
{%- endif -%}
{%- endset -%}
